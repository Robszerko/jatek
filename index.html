<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>SzóNyomozó</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Roboto+Mono:wght@500;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg-gradient-start: #3d405b; --bg-gradient-end: #2c2f48; --container-bg: rgba(244, 241, 222, 0.95);
            --text-color: #3d405b; --title-color: #e07a5f; --border-color-idle: #bcaaa4;
            --border-color-active: #8d6e63; --correct-color: #81b29a; --present-color: #f2cc8f;
            --absent-color: #9e9e9e; --key-bg: #dcd3b8; --key-text: #3d405b;
            --key-shadow: 0 3px 0 #bcaaa4; --font-title: 'Fredoka One', cursive; --font-main: 'Roboto Mono', monospace;
            --difficulty-easy: #388e3c; --difficulty-hard: #f57c00; --difficulty-extra: #d32f2f;
            --fail-color: #e53935;
        }

        .theme-forest { --bg-gradient-start: #2d6a4f; --bg-gradient-end: #1b4332; --container-bg: rgba(247, 246, 242, 0.95); --text-color: #081c15; --title-color: #74c69d; --border-color-idle: #b7e4c7; --border-color-active: #95d5b2; --correct-color: #52b788; --present-color: #ffd60a; --absent-color: #9e9e9e; --key-bg: #d8f3dc; --key-text: #1b4332; --key-shadow: 0 3px 0 #b7e4c7; }
        .theme-ocean { --bg-gradient-start: #0077b6; --bg-gradient-end: #023e8a; --container-bg: rgba(237, 246, 249, 0.95); --text-color: #03045e; --title-color: #00b4d8; --border-color-idle: #ade8f4; --border-color-active: #90e0ef; --correct-color: #48cae4; --present-color: #ffc300; --absent-color: #adb5bd; --key-bg: #caf0f8; --key-text: #023e8a; --key-shadow: 0 3px 0 #ade8f4; }
        .theme-sunset { --bg-gradient-start: #f77f00; --bg-gradient-end: #d62828; --container-bg: rgba(255, 250, 240, 0.95); --text-color: #800f2f; --title-color: #fcbf49; --border-color-idle: #eae2b7; --border-color-active: #f77f00; --correct-color: #70e000; --present-color: #fcbf49; --absent-color: #bc6c25; --key-bg: #fff1e6; --key-text: #d62828; --key-shadow: 0 3px 0 #eae2b7; }
        .theme-night { --bg-gradient-start: #232526; --bg-gradient-end: #000000; --container-bg: rgba(42, 42, 42, 0.95); --text-color: #e0e0e0; --title-color: #7f5af0; --border-color-idle: #6c757d; --border-color-active: #9a9a9a; --correct-color: #2cb67d; --present-color: #ffc107; --absent-color: #495057; --key-bg: #343a40; --key-text: #f8f9fa; --key-shadow: 0 3px 0 #495057; }
        .theme-rose { --bg-gradient-start: #c9184a; --bg-gradient-end: #8c0f32; --container-bg: rgba(255, 240, 243, 0.95); --text-color: #590d22; --title-color: #ff758f; --border-color-idle: #ffb3c1; --border-color-active: #ff8fa3; --correct-color: #a9def9; --present-color: #fcf6bd; --absent-color: #c9ada7; --key-bg: #ffe5ec; --key-text: #8c0f32; --key-shadow: 0 3px 0 #ffb3c1; }
        .theme-vintage { --bg-gradient-start: #a27b5c; --bg-gradient-end: #3f2f25; --container-bg: rgba(243, 235, 226, 0.95); --text-color: #3f2f25; --title-color: #7b553c; --border-color-idle: #dcd0c0; --border-color-active: #c0b2a4; --correct-color: #8c7a6b; --present-color: #e6b8a2; --absent-color: #9c8978; --key-bg: #efebe5; --key-text: #3f2f25; --key-shadow: 0 3px 0 #dcd0c0; }
        .theme-meadow { --bg-gradient-start: #7cb518; --bg-gradient-end: #5c8001; --container-bg: rgba(248, 255, 242, 0.95); --text-color: #436129; --title-color: #aacc00; --border-color-idle: #d4e09b; --border-color-active: #b5c77e; --correct-color: #9ef01a; --present-color: #f7d622; --absent-color: #90a955; --key-bg: #f2f7e5; --key-text: #436129; --key-shadow: 0 3px 0 #d4e09b; }
        .theme-royal { --bg-gradient-start: #5a189a; --bg-gradient-end: #3c096c; --container-bg: rgba(243, 237, 247, 0.95); --text-color: #3c096c; --title-color: #9d4edd; --border-color-idle: #d8b4fe; --border-color-active: #c792fe; --correct-color: #7b2cbf; --present-color: #fca311; --absent-color: #b1a7a6; --key-bg: #e9d8fd; --key-text: #3c096c; --key-shadow: 0 3px 0 #d8b4fe; }
        .theme-hacker { --bg-gradient-start: #0c0c0c; --bg-gradient-end: #000000; --container-bg: rgba(10, 25, 10, 0.9); --text-color: #00ff00; --title-color: #00ff00; --border-color-idle: #008000; --border-color-active: #32cd32; --correct-color: #32cd32; --present-color: #adff2f; --absent-color: #556b2f; --key-bg: #111; --key-text: #00ff00; --key-shadow: 0 3px 0 #008000; font-family: 'Roboto Mono', monospace; }

        body {
            background-color: var(--bg-gradient-end);
            background-image: radial-gradient(circle at top left, rgba(255, 255, 255, 0.1) 0%, transparent 40%), url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.08'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            color: var(--text-color);
            font-family: var(--font-main);
            display: flex; justify-content: center; align-items: flex-start; padding: 15px; box-sizing: border-box;
            -webkit-user-select: none; user-select: none; touch-action: manipulation;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        #game-container {
            background-color: var(--container-bg);
            border-radius: 20px; border: 2px solid rgba(255,255,255,0.2); box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            display: flex; flex-direction: column; align-items: center; width: 100%; max-width: 600px;
            padding: clamp(15px, 4vw, 30px); box-sizing: border-box; margin-top: 1vh; position: relative;
            transition: background-color 0.3s ease;
        }
        header { display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 0; margin-bottom: 20px; position: relative; width: 100%; }
        #header-main { display: flex; align-items: center; justify-content: center; position: relative; }
        #logo-container { display: flex; align-items: center; position: relative; }
        #logo-svg { width: clamp(80px, 20vw, 100px); height: auto; z-index: 1; }
        #logo-svg .logo-circle { stroke: url(#grad1); fill: var(--container-bg); transition: fill 0.3s ease; }
        #logo-svg .logo-handle { stroke: url(#grad1); }
        #logo-svg .logo-text { fill: var(--text-color); transition: fill 0.3s ease; }
        #logo-svg stop { transition: stop-color 0.3s ease; }
        
        header h1 {
            font-family: var(--font-title); color: var(--title-color); font-size: clamp(2rem, 9vw, 3rem); margin: 0;
            letter-spacing: 0.05em; margin-left: -2px; z-index: 0; transition: color 0.3s ease;
        }
        #title-container { position: relative; display: flex; align-items: center; }
        #copyright-notice { font-size: 0.7rem; color: var(--text-color); opacity: 0.7; margin-top: 2px; transition: color 0.3s ease, opacity 0.3s ease; }

        #theme-toggle-button { width: 28px; height: 28px; cursor: pointer; z-index: 10; transition: transform 0.2s ease; margin-left: 10px; }
        #theme-toggle-button:hover { transform: scale(1.2) rotate(15deg); }
        #theme-toggle-button svg { fill: var(--title-color); transition: fill 0.3s ease; width: 100%; height: 100%; }
        #theme-picker {
            position: absolute; top: 100%; right: 0; margin-top: 10px; background-color: var(--container-bg);
            border: 2px solid var(--border-color-idle); border-radius: 10px; padding: 10px; display: flex;
            flex-wrap: wrap; gap: 8px; width: 150px; z-index: 20; box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .theme-swatch { width: 30px; height: 30px; border-radius: 50%; cursor: pointer; border: 2px solid var(--border-color-idle); transition: transform 0.2s ease, box-shadow 0.2s ease; }
        .theme-swatch:hover { transform: scale(1.1); box-shadow: 0 0 5px var(--title-color); }
        .theme-swatch.active { border: 3px solid var(--title-color); box-shadow: 0 0 8px var(--title-color); }
        
        #daily-score-display { font-family: var(--font-main); font-size: 1.1rem; font-weight: 700; color: var(--title-color); background: rgba(0,0,0,0.05); padding: 5px 15px; border-radius: 20px; border: 2px solid var(--border-color-idle); margin-top: 10px; transition: color 0.3s ease, border-color 0.3s ease; }
        
        #word-tracker { display: flex; justify-content: center; gap: 10px; margin-bottom: 10px; flex-wrap: wrap; }
        .tracker-item { flex: 1; min-width: 60px; padding: 10px 5px; text-align: center; border-radius: 8px; border: 2px solid var(--border-color-idle); font-weight: 500; cursor: pointer; transition: all 0.3s ease; position: relative; }
        .tracker-item.active { border-color: var(--title-color); box-shadow: 0 0 8px var(--title-color); }
        .tracker-item.solved { background-color: var(--correct-color); border-color: var(--correct-color); color: white; cursor: not-allowed;}
        .tracker-item.failed { background-color: var(--fail-color); border-color: var(--fail-color); color: white; }
        .tracker-item .cooldown-timer { font-size: 0.8em; font-weight: bold; margin-top: 4px; }
        
        #info-bar { width: 100%; display: flex; justify-content: space-between; align-items: center; padding: 12px 0; min-height: 50px; margin-bottom: 5px; }
        #info-bar.feedback-message { justify-content: center; font-size: 1.2rem; font-weight: bold; }
        #info-bar.feedback-message strong { color: var(--title-color); }
        
        #game-mode-toggle { display: flex; align-items: center; cursor: pointer; background-color: rgba(0,0,0,0.05); padding: 5px 10px; border-radius: 20px; }
        #game-mode-toggle span { font-weight: 700; font-size: 0.9rem; }
        #timer-display { font-weight: 700; font-size: 1.1em; color: var(--title-color); margin-left: 8px; }
        
        #word-info-container { display: flex; flex-direction: column; align-items: flex-start; text-align: left; }
        #difficulty-display { font-weight: 700; margin-top: 4px; border-radius: 10px; padding: 3px 10px; color: white; font-size: 0.9em; text-transform: uppercase; letter-spacing: 0.5px; text-shadow: 1px 1px 2px rgba(0,0,0,0.25); border: 1px solid rgba(255,255,255,0.3); }
        .difficulty-könnyű { background-color: var(--difficulty-easy); } .difficulty-nehéz { background-color: var(--difficulty-hard); } .difficulty-extra-nehéz { background-color: var(--difficulty-extra); }
        
        #hint-display-area { display: none; width: 100%; padding: 15px; margin-bottom: 15px; background-color: rgba(0,0,0,0.05); border: 2px solid var(--border-color-idle); border-radius: 10px; text-align: center; font-style: italic; opacity: 0; transition: opacity 0.5s ease; }
        #hint-display-area.active { display: block; opacity: 1; }
        #hint-display-area strong { color: var(--title-color); font-style: normal; }
        
        #grid-container { display: grid; grid-template-rows: repeat(6, 1fr); gap: 5px; width: 100%; max-width: 500px; margin: 0 auto 20px auto; aspect-ratio: 5 / 6; }
        .grid-row { display: grid; gap: 5px; }
        .grid-cell { perspective: 1000px; }
        .cell-inner { position: relative; width: 100%; height: 100%; transition: transform 0.6s; transform-style: preserve-3d; }
        .grid-cell.flip .cell-inner { transform: rotateX(180deg); }
        .cell-face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; display: flex; justify-content: center; align-items: center; font-size: clamp(1.5rem, 5vw, 2.2rem); font-weight: bold; text-transform: uppercase; box-sizing: border-box; border-radius: 8px; }
        .cell-front { border: 3px solid var(--border-color-idle); transition: border-color 0.2s ease; }
        .grid-cell.filled .cell-front:not(.cell-revealed) { border-color: var(--border-color-active); animation: pop 0.2s; }
        @keyframes pop { 50% { transform: scale(1.1); } }
        .cell-revealed { border-color: var(--correct-color); background-color: rgba(129, 178, 154, 0.2); }
        .cell-back { color: white; transform: rotateX(180deg); border: 3px solid transparent; }
        .cell-back.correct { background-color: var(--correct-color); border-color: var(--correct-color);} .cell-back.present { background-color: var(--present-color); border-color: var(--present-color);} .cell-back.absent  { background-color: var(--absent-color); border-color: var(--absent-color);}
        
        #hint-controls { display: flex; justify-content: center; gap: 10px; margin-bottom: 25px; width: 100%; }
        .hint-button { color: white; border: none; padding: 10px 15px; border-radius: 8px; cursor: pointer; font-weight: 700; transition: all 0.2s; font-size: 0.9rem; flex-grow: 1; max-width: 250px; }
        .hint-button#request-text-hint-button { background-color: var(--present-color); box-shadow: 0 3px 0 #d0a457; }
        .hint-button#request-letter-hint-button { background-color: var(--correct-color); box-shadow: 0 3px 0 #6a9982; }
        .hint-button:hover:not(:disabled) { transform: translateY(-2px); }
        .hint-button:disabled { background-color: var(--absent-color); cursor: not-allowed; box-shadow: none; opacity: 0.7; }
        
        #keyboard-container { display: flex; flex-direction: column; gap: clamp(6px, 1.5vw, 10px); width: 100%; max-width: 900px; margin: 0 auto; }
        .keyboard-row { display: flex; justify-content: center; gap: clamp(3px, 1vw, 6px); }
        .key { font-family: var(--font-main); font-weight: 500; border: none; border-radius: 6px; height: clamp(45px, 12vw, 60px); flex-grow: 1; cursor: pointer; text-transform: uppercase; font-size: clamp(0.8rem, 3vw, 1.4rem); display: flex; justify-content: center; align-items: center; padding: 0; background-color: var(--key-bg); color: var(--key-text); box-shadow: var(--key-shadow); transition: all 0.1s ease-in-out, background-color 0.3s ease, color 0.3s ease; }
        .key:active, .key.active-press { transform: translateY(2px); box-shadow: none; }
        .key.large { flex-grow: 1.5; font-size: clamp(0.7rem, 2.5vw, 1rem); }
        .key.correct, .key.correct:hover { background-color: var(--correct-color); color: white; } .key.present, .key.present:hover { background-color: var(--present-color); color: white; } .key.absent, .key.absent:hover { background-color: var(--absent-color); color: white; opacity: 0.7; }
        #keyboard-container.disabled .key { cursor: not-allowed; opacity: 0.6; }

        #idle-message-container { text-align: center; padding: 40px 20px; line-height: 1.8; border: 2px dashed var(--border-color-idle); border-radius: 15px; margin: 20px 0; }
        #idle-message-container h3 { font-family: var(--font-title); color: var(--title-color); font-size: 1.6rem; margin: 0 0 15px 0; }
        #idle-message-container p { margin: 0; font-size: 1.1rem; }

        #rules-container { margin-top: 30px; padding-top: 20px; border-top: 2px solid var(--border-color-idle); line-height: 1.7; width: 100%; color: var(--text-color); transition: color 0.3s ease, border-color 0.3s ease; }
        #rules-container h3 { font-family: var(--font-title); color: var(--title-color); text-align: center; font-size: 1.5rem; margin: 0 0 15px 0; }
        #rules-container ul { list-style-type: '🕵️ '; padding-left: 20px; text-align: left; margin: 0; }
        #rules-container li { margin-bottom: 12px; padding-left: 8px; }
        
        #unlock-bonus-button { opacity: 0.5; cursor: not-allowed; background-color: var(--difficulty-extra); color: white; border: 2px solid white; border-radius: 10px; padding: 15px 30px; font-family: var(--font-title); font-size: 1.2rem; letter-spacing: 1px; margin: 20px 0; text-shadow: 1px 1px 3px rgba(0,0,0,0.4); }
        #unlock-bonus-button.unlocked { opacity: 1; cursor: pointer; }
        #unlock-bonus-button.pulse { animation: pulse 2s infinite; }
        @keyframes pulse { 0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(211, 47, 47, 0.7); } 70% { transform: scale(1); box-shadow: 0 0 0 10px rgba(211, 47, 47, 0); } 100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(211, 47, 47, 0); } }
        
        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.85); display: flex; justify-content: center; align-items: center; z-index: 1000; opacity: 0; visibility: hidden; transition: opacity 0.3s ease, visibility 0s 0.3s; }
        .overlay.visible { opacity: 1; visibility: visible; transition-delay: 0s; }
        .overlay-content { background-color: var(--container-bg); color: var(--text-color); transition: background-color 0.3s ease, color 0.3s ease; padding: clamp(20px, 4vw, 30px); border-radius: 20px; text-align: center; box-shadow: 0 5px 25px rgba(0,0,0,0.3); max-width: 95vw; width: auto; max-height: 95vh; overflow-y: auto; display: flex; flex-direction: column; gap: 15px; }
        .overlay-content h2 { font-family: var(--font-title); color: var(--title-color); margin: 0 0 10px 0; font-size: clamp(1.5rem, 6vw, 2.2rem); }
        #refresh-button, #close-wheel-button { background-color: var(--title-color); color: white; border: none; padding: 12px 25px; border-radius: 8px; font-family: var(--font-main); font-weight: 700; font-size: 1rem; cursor: pointer; margin-top: 15px; transition: transform 0.2s ease, background-color 0.3s ease; }
        
        #wheel-game-container { display: flex; flex-direction: column; align-items: center; gap: 15px; }
        #wheel-wrapper { position: relative; width: 300px; height: 300px; margin: 10px auto; }
        #wheel-pointer { width: 0; height: 0; border-left: 20px solid transparent; border-right: 20px solid transparent; border-top: 40px solid var(--fail-color); position: absolute; top: -15px; left: 50%; transform: translateX(-50%); z-index: 10; transition: border-top-color 0.3s ease; }
        #wheel { width: 100%; height: 100%; transition: transform 4s cubic-bezier(0.25, 0.1, 0.25, 1); }
        #wheel-game-ui { display: flex; flex-direction: column; align-items: center; gap: 15px; width: 100%; }
        #wheel-round-display { font-size: 1.2rem; font-weight: bold; color: var(--title-color); }
        #wheel-stats-container { font-size: 1.1rem; font-weight: bold; background: rgba(0,0,0,0.05); padding: 8px 15px; border-radius: 10px; border: 2px solid var(--border-color-idle); }
        #wheel-winnings-display { color: var(--difficulty-easy); }
        #puzzle-category { font-size: 1rem; font-weight: bold; background: var(--title-color); color: white; padding: 5px 15px; border-radius: 10px; }
        #puzzle-board { display: flex; flex-wrap: wrap; justify-content: center; gap: 4px; max-width: 100%; padding: 10px; align-items: center; }
        .puzzle-tile { width: 32px; height: 42px; border-radius: 5px; perspective: 1000px; flex-shrink: 0; }
        .puzzle-tile:not(.space) { border: 2px solid #fff; }
        .puzzle-tile.space { background-color: transparent; border: none; width: 15px; }
        .tile-inner { position: relative; width: 100%; height: 100%; transition: transform 0.6s; transform-style: preserve-3d; }
        .puzzle-tile:not(.space) .tile-inner { background-color: var(--correct-color); }
        .puzzle-tile.revealed .tile-inner { transform: rotateY(180deg); }
        .tile-face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; display: flex; justify-content: center; align-items: center; }
        .tile-front { background-color: var(--correct-color); }
        .tile-back { background-color: #fff; color: var(--text-color); font-weight: bold; font-size: 1.5rem; transform: rotateY(180deg); }
        
        #wheel-message-display { min-height: 2.5em; font-size: 1.1rem; font-weight: bold; color: var(--title-color); text-align: center; transition: opacity 0.3s ease; }

        #wheel-alphabet-panel { display: flex; flex-wrap: wrap; justify-content: center; gap: 5px; max-width: 95%; margin: 10px 0; }
        .alphabet-key { width: 30px; height: 30px; border: 2px solid var(--border-color-idle); border-radius: 5px; background-color: var(--key-bg); color: var(--key-text); font-weight: bold; cursor: pointer; transition: all 0.2s; }
        .alphabet-key.guessed { background-color: var(--absent-color); color: white; opacity: 0.6; cursor: not-allowed; }
        .alphabet-key.vowel { border-color: var(--present-color); }
        #wheel-controls, #wheel-decision-controls { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; }
        #wheel-controls button, #wheel-decision-controls button { padding: 10px 15px; font-size: 1rem; }
        #cash-out-button { background-color: var(--difficulty-easy); box-shadow: 0 3px 0 #2e7d32; }
        #next-round-button { background-color: var(--difficulty-hard); box-shadow: 0 3px 0 #c46400; }
        #power-meter-container { width: 80%; max-width: 400px; height: 20px; background-color: #ccc; border-radius: 10px; overflow: hidden; margin-top: 10px; cursor: pointer; border: 2px solid var(--text-color); }
        #power-meter-bar { width: 0%; height: 100%; background: linear-gradient(90deg, #f2cc8f, #e07a5f, var(--fail-color)); }
        .power-up { animation: power-up 1.5s linear infinite; }
        @keyframes power-up { 0% { width: 0%; } 50% { width: 100%; } 100% { width: 0%; } }
    </style>
</head>
<body class="theme-classic">
    <div id="game-container">
        <header>
            <div id="header-main">
                <div id="logo-container">
                    <svg id="logo-svg" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                        <defs>
                            <linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop class="grad-stop1" offset="0%" style="stop-color: var(--title-color);stop-opacity:1" />
                                <stop class="grad-stop2" offset="100%" style="stop-color: var(--text-color);stop-opacity:1" />
                            </linearGradient>
                        </defs>
                        <circle class="logo-circle" cx="50" cy="50" r="40" stroke-width="12"/>
                        <line class="logo-handle" x1="32" y1="72" x2="5" y2="95" stroke-width="16" stroke-linecap="round"/>
                        <text class="logo-text" x="50" y="62" font-family="Fredoka One, cursive" font-size="38" text-anchor="middle">Szó</text>
                    </svg>
                </div>
                <div style="text-align: center; position: relative;">
                    <div id="title-container">
                        <h1>Nyomozó</h1>
                        <div id="theme-toggle-button" title="Színtéma választása">
                            <svg viewBox="0 0 24 24"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path></svg>
                        </div>
                    </div>
                    <div id="copyright-notice">© by Robi</div>
                    <div id="theme-picker" style="display: none;"></div>
                </div>
            </div>
            <div id="daily-score-display">Mai pontszám: <span>0</span></div>
        </header>
        
        <div id="word-tracker"></div>
        <button id="unlock-bonus-button" disabled>🏆 Szerencsekerék 🏆</button>
        
        <div id="info-bar">
            <!-- Tartalom JS-ből -->
        </div>

        <main id="grid-container"></main>
        
        <div id="hint-display-area"></div>
        
        <div id="hint-controls">
            <button id="request-text-hint-button" class="hint-button">Szöveges segítség</button>
            <button id="request-letter-hint-button" class="hint-button">Betű felfedése</button>
        </div>
        
        <div id="keyboard-container"></div>

        <div id="idle-message-container" style="display: none;"></div>
        
        <div id="rules-container">
             <h3>Játékszabályok</h3>
            <ul>
                <li><strong>Alapjáték:</strong> Óránként 5 új szót kapsz, amik legalább 6 óráig nem ismétlődnek. A helyes megfejtésért pont jár.</li>
                <li><strong>Játékmód:</strong> Dönthetsz, hogy "Relax" módban, időkorlát nélkül, vagy "Időfutam" módban, időre játszol. Az időfutam több pontot ér!</li>
                <li><strong style="color:var(--fail-color)">Újrapróbálás:</strong> Ha nem sikerül egy szó, 15 perc múlva újra próbálkozhatsz vele, hogy esélyed legyen a bónusz játékra.</li>
                <li><strong>Szerencsekerék:</strong> Ha mind az 5 szót megfejted, feloldod a bónusz játékot, ahol a pontjaidat kockáztathatod a nagyobb nyereményért.</li>
            </ul>
        </div>
    </div>

    <div id="new-set-overlay" class="overlay">
        <div class="overlay-content">
            <h2>Új Feladványok!</h2>
            <p>Új óra kezdődött, friss szavak várnak rád.</p>
            <button id="refresh-button">Frissítés</button>
        </div>
    </div>
    
    <div id="wheel-game-overlay" class="overlay">
        <div class="overlay-content">
            <div id="wheel-game-container">
                <h2>Szerencsekerék</h2>
                <div id="wheel-round-display"></div>
                <div id="wheel-game-ui">
                    <div id="wheel-stats-container">
                        <div id="wheel-stake-display">Tét: <span id="stake-amount">0</span></div>
                        <div id="wheel-winnings-display">Nyeremény: <span id="player-score">0</span></div>
                    </div>
                    <div id="puzzle-category"></div>
                    <div id="puzzle-board"></div>
                    <div id="wheel-alphabet-panel"></div>
                    <div id="wheel-message-display"></div>
                    <div id="wheel-wrapper">
                        <div id="wheel-pointer"></div>
                        <svg id="wheel" viewBox="0 0 100 100"></svg>
                    </div>
                    <div id="power-meter-container" title="Kattints a pörgetéshez, majd a megfelelő erősségnél újra a megállításhoz!">
                        <div id="power-meter-bar"></div>
                    </div>
                    <div id="wheel-controls">
                        <button id="spin-button" class="hint-button">Pörgetés</button>
                        <button id="solve-button" class="hint-button" disabled>Megfejtem</button>
                    </div>
                     <div id="wheel-decision-controls" style="display: none;">
                        <button id="cash-out-button" class="hint-button">Nyeremény felvétele</button>
                        <button id="next-round-button" class="hint-button">Következő kör</button>
                    </div>
                </div>
                <button id="close-wheel-button" style="display: none;">Bezárás</button>
            </div>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- ADATOK (szavak.js tartalma) ---
        const wordData = [
            {word:"HÁZ", category:"Épület", difficulty:"Könnyű", hints:["Lakni lehet benne.", "Teteje és falai vannak.", "Lehet családi vagy társas."]}, {word:"NAP", category:"Égitest", difficulty:"Könnyű", hints:["Fényt és meleget ad.", "Körülötte kering a Föld.", "A Naprendszer központi csillaga."]}, {word:"VÍZ", category:"Folyadék", difficulty:"Könnyű", hints:["Az élet alapja.", "Képlete: H₂O.", "Lehet folyó, tó vagy tenger."]}, {word:"KŐ", category:"Természet", difficulty:"Könnyű", hints:["Kemény, szilárd anyag.", "Az ollót legyőzi a játékban.", "Építkezéshez is használják."]}, {word:"ÉG", category:"Természet", difficulty:"Könnyű", hints:["Felettünk terül el.", "Nappal kék, éjjel fekete.", "Felhők úsznak rajta."]}, {word:"SÓ", category:"Étel", difficulty:"Könnyű", hints:["Fehér, kristályos fűszer.", "A tengerben is megtalálható.", "Túlzott fogyasztása egészségtelen."]}, {word:"KOR", category:"Fogalom", difficulty:"Könnyű", hints:["Időszakot jelöl.", "Lehet új- vagy közép-.", "Az ember életének szakaszait is jelöli."]}, {word:"ÁGY", category:"Bútor", difficulty:"Könnyű", hints:["Alvásra használjuk.", "Párna és takaró tartozik hozzá.", "A hálószoba központi eleme."]}, {word:"ÚT", category:"Hely", difficulty:"Könnyű", hints:["Két pontot köt össze.", "Járművek közlekednek rajta.", "Lehet aszfalt vagy föld."]}, {word:"TŰZ", category:"Jelenség", difficulty:"Könnyű", hints:["Égés során keletkezik.", "Meleget és fényt ad.", "Vigyázni kell vele, mert veszélyes."]},
            {word:"FA", category:"Növény", difficulty:"Könnyű", hints:["Levelei, törzse és ágai vannak.", "Papírt készítenek belőle.", "Oxigént termel."]}, {word:"AUTÓ", category:"Jármű", difficulty:"Könnyű", hints:["Négy kereke van.", "Benzinnel vagy árammal működik.", "Jogosítvány kell a vezetéséhez."]}, {word:"KERT", category:"Hely", difficulty:"Könnyű", hints:["A ház körül található.", "Növényeket ültetnek ide.", "Lehet veteményes vagy virágos."]}, {word:"HÍD", category:"Építmény", difficulty:"Könnyű", hints:["Víz felett vezet át.", "Összeköti a két partot.", "Pilléreken áll."]}, {word:"HEGY", category:"Természet", difficulty:"Könnyű", hints:["Magas földrajzi képződmény.", "A völgy ellentéte.", "Télen síelni lehet rajta."]}, {word:"KÉP", category:"Tárgy", difficulty:"Könnyű", hints:["Vizuális alkotás.", "A falra akasztják.", "Lehet festmény vagy fénykép."]}, {word:"EBÉD", category:"Étel", difficulty:"Könnyű", hints:["Déli étkezés.", "Gyakran leves és főétel.", "Munkahelyen is van rá szünet."]}, {word:"BOR", category:"Ital", difficulty:"Könnyű", hints:["Szőlőből készül.", "Lehet vörös vagy fehér.", "A pincében tárolják."]}, {word:"CÉL", category:"Fogalom", difficulty:"Könnyű", hints:["Elérendő dolog.", "A sportoló erre törekszik.", "Lehet rövid vagy hosszú távú."]}, {word:"TÓ", category:"Természet", difficulty:"Könnyű", hints:["Állóvíz.", "A Balaton a legnagyobb ilyen nálunk.", "Horgászni és csónakázni lehet rajta."]},
            {word:"HÓ", category:"Időjárás", difficulty:"Könnyű", hints:["Téli csapadék.", "Hóembert építenek belőle.", "Fagyott vízkristályokból áll."]}, {word:"PAD", category:"Bútor", difficulty:"Könnyű", hints:["Ülőalkalmatosság.", "Parkban vagy iskolában is van.", "Több ember is elfér rajta."]}, {word:"SAJT", category:"Étel", difficulty:"Könnyű", hints:["Tejtermék.", "Az egér kedvence a mesékben.", "Lehet trappista vagy parmezán."]}, {word:"JÉG", category:"Halmazállapot", difficulty:"Könnyű", hints:["Fagyott víz.", "Italokba teszik hűsítésre.", "A korcsolyapálya ebből van."]}, {word:"BANK", category:"Intézmény", difficulty:"Könnyű", hints:["Pénzzel foglalkozik.", "Hiteleket nyújt.", "ATM-et üzemeltet."]}, {word:"ERDŐ", category:"Hely", difficulty:"Könnyű", hints:["Sok fa együttese.", "A róka lakhelye.", "Kirándulni lehet benne."]}, {word:"KULCS", category:"Tárgy", difficulty:"Könnyű", hints:["Ajtót nyit és zár.", "Zárba illik.", "Gyakran karikán tartják."]}, {word:"PÉNZ", category:"Eszköz", difficulty:"Könnyű", hints:["Fizetésre használjuk.", "Lehet érme vagy bankjegy.", "A hiánya gyakori probléma."]}, {word:"HANG", category:"Jelenség", difficulty:"Könnyű", hints:["A fülünkkel érzékeljük.", "A csend ellentéte.", "A levegő rezgése."]}, {word:"CIPŐ", category:"Ruhanemű", difficulty:"Könnyű", hints:["A lábunkra vesszük.", "Véd a sérülésektől.", "Lehet sport- vagy elegáns."]},
            {word:"HOMOK", category:"Anyag", difficulty:"Könnyű", hints:["Apró szemcsékből áll.", "A sivatagban és a tengerparton is van.", "Homokvárat építenek belőle."]}, {word:"AJTÓ", category:"Nyílászáró", difficulty:"Könnyű", hints:["Be- és kilépésre szolgál.", "Lehet nyitva vagy csukva.", "Van kilincse."]}, {word:"MESE", category:"Irodalom", difficulty:"Könnyű", hints:["Kitalált történet.", "Gyakran happy end a vége.", "A jó elnyeri jutalmát, a rossz a büntetését."]}, {word:"NYÁR", category:"Évszak", difficulty:"Könnyű", hints:["A legmelegebb évszak.", "Ilyenkor van a vakáció.", "Sokan mennek nyaralni."]}, {word:"LÁZ", category:"Tünet", difficulty:"Könnyű", hints:["Magas testhőmérséklet.", "Betegség jele.", "Hőmérővel mérik."]}, {word:"DÍJ", category:"Elismerés", difficulty:"Könnyű", hints:["Jutalom valamiért.", "A győztes kapja.", "Lehet serleg vagy érem."]}, {word:"PITE", category:"Étel", difficulty:"Könnyű", hints:["Gyümölcsös sütemény.", "Lehet almás vagy meggyes.", "Gyakran rácsos a teteje."]}, {word:"ASZTAL", category:"Bútor", difficulty:"Könnyű", hints:["Étkezésre, munkára használjuk.", "Általában négy lába van.", "Terítővel borítják le."]}, {word:"POHÁR", category:"Eszköz", difficulty:"Könnyű", hints:["Ebből iszunk.", "Lehet üvegből vagy műanyagból.", "Koccintani is szoktak vele."]}, {word:"MADÁR", category:"Állat", difficulty:"Könnyű", hints:["Tollas, repülő állat.", "Fészket rak.", "Csicsereg."]},
            {word:"HAJÓ", category:"Jármű", difficulty:"Könnyű", hints:["Vízen közlekedik.", "Lehet vitorlás vagy motoros.", "A kapitány irányítja."]}, {word:"KENYÉR", category:"Étel", difficulty:"Könnyű", hints:["Alapvető élelmiszer.", "Pékségben sütik.", "Szeletekre vágva fogyasztják."]}, {word:"VIRÁG", category:"Növény", difficulty:"Könnyű", hints:["Színes és illatos.", "Nőnapra adják.", "Vázába teszik."]}, {word:"SZÉK", category:"Bútor", difficulty:"Könnyű", hints:["Ülésre használjuk.", "Háttámlája van.", "Az asztal mellett áll."]}, {word:"ALMA", category:"Gyümölcs", difficulty:"Könnyű", hints:["Piros vagy zöld gyümölcs.", "Egy közmondás szerint távol tartja az orvost.", "A pite gyakori tölteléke."]}, {word:"VONAT", category:"Jármű", difficulty:"Könnyű", hints:["Sínen közlekedik.", "Vagonokból áll.", "Mozdony húzza."]}, {word:"LÁMPA", category:"Tárgy", difficulty:"Könnyű", hints:["Fényt ad a sötétben.", "Lehet asztali vagy álló.", "Villanykörte van benne."]}, {word:"FALU", category:"Település", difficulty:"Könnyű", hints:["Kisebb, mint a város.", "Gyakran van temploma és kocsmája.", "Nyugodtabb az élet, mint a városban."]}, {word:"ANYA", category:"Személy", difficulty:"Könnyű", hints:["Nőnemű szülő.", "Ő hordta a szív alatt.", "Gondoskodik a gyermekeiről."]}, {word:"KUTYA", category:"Állat", difficulty:"Könnyű", hints:["Az ember legjobb barátja.", "Ugat és csóválja a farkát.", "Házőrzésre is használják."]},
            {word:"CSOKI", category:"Édesség", difficulty:"Könnyű", hints:["Kakaóbabból készül.", "Lehet tej- vagy ét-.", "A gyerekek egyik kedvence."]}, {word:"ISKOLA", category:"Épület", difficulty:"Könnyű", hints:["Itt tanulnak a gyerekek.", "Szünetben nagy a zaj.", "Tanárok és diákok alkotják közösségét."]}, {word:"KÖNYV", category:"Tárgy", difficulty:"Könnyű", hints:["Oldalakból és borítóból áll.", "Olvasásra való.", "A könyvtárban kölcsönözhető."]}, {word:"LABDA", category:"Játék", difficulty:"Könnyű", hints:["Gömbölyű sportszer.", "Rúgni vagy dobni lehet.", "A focihoz elengedhetetlen."]}, {word:"ZENE", category:"Művészet", difficulty:"Könnyű", hints:["Hangok művészi elrendezése.", "Rádióban szól.", "Lehet komoly vagy könnyű."]}, {word:"TÉL", category:"Évszak", difficulty:"Könnyű", hints:["A leghidegebb évszak.", "Karácsony és hó.", "Ilyenkor kell a kabát és a sál."]}, {word:"FILM", category:"Művészet", difficulty:"Könnyű", hints:["Mozgóképes alkotás.", "Moziban vagy tévében nézik.", "Rendező készíti."]}, {word:"SZÍN", category:"Tulajdonság", difficulty:"Könnyű", hints:["A fény egy tulajdonsága.", "A szivárványban sok van belőle.", "Lehet piros, kék, sárga."]}, {word:"SZÓ", category:"Nyelvészet", difficulty:"Könnyű", hints:["Jelentéssel bíró betűsor.", "Ebből áll a mondat.", "A játék lényege ennek a kitalálása."]}, {word:"CSEND", category:"Állapot", difficulty:"Könnyű", hints:["A zaj hiánya.", "A könyvtárban elvárás.", "Néha aranyat ér."]},
            {word:"ÁLOM", category:"Jelenség", difficulty:"Könnyű", hints:["Alvás közben látjuk.", "Lehet szép vagy ijesztő.", "Freud sokat foglalkozott vele."]}, {word:"KÉS", category:"Eszköz", difficulty:"Könnyű", hints:["Vágásra használják.", "Éles a pengéje.", "A villával és kanállal együtt evőeszköz."]}, {word:"IDŐ", category:"Fogalom", difficulty:"Könnyű", hints:["Múlik és mérhető.", "Óra, nap, év.", "A pénzhez szokták hasonlítani."]}, {word:"SZÍV", category:"Szerv", difficulty:"Könnyű", hints:["A szeretet jelképe.", "A vért pumpálja.", "Dobog."]}, {word:"BABA", category:"Személy", difficulty:"Könnyű", hints:["Kisgyermek.", "Sír, ha éhes.", "Cumit használ."]}, {word:"JÁTÉK", category:"Cselekvés", difficulty:"Könnyű", hints:["Szórakoztató tevékenység.", "Nem munka.", "A gyerekek sokat csinálják."]}, {word:"MAJOM", category:"Állat", difficulty:"Könnyű", hints:["Fán élő emlős.", "Szereti a banánt.", "Az ember rokona."]}, {word:"ORR", category:"Testrész", difficulty:"Könnyű", hints:["Szaglószerv.", "Az arc közepén van.", "Megfázáskor folyik."]}, {word:"KEFE", category:"Eszköz", difficulty:"Könnyű", hints:["Tisztításra használják.", "Lehet fog-, haj- vagy köröm-.", "Sörtéi vannak."]}, {word:"KÁVÉ", category:"Ital", difficulty:"Könnyű", hints:["Reggeli, élénkítő ital.", "Lehet presszó vagy hosszú.", "Cukorral és tejjel is isszák."]},
            {word:"TEA", category:"Ital", difficulty:"Könnyű", hints:["Forró ital, gyógynövényből.", "Lehet fekete vagy zöld.", "Angliában délután isszák."]}, {word:"FÜL", category:"Testrész", difficulty:"Könnyű", hints:["A hallás szerve.", "Páros szerv a fej két oldalán.", "Fülbevalót viselnek benne."]}, {word:"FOG", category:"Testrész", difficulty:"Könnyű", hints:["Rágásra használjuk.", "A fogorvos kezeli.", "Lehet tej- vagy maradó."]}, {word:"KÉZ", category:"Testrész", difficulty:"Könnyű", hints:["Öt ujja van.", "Írásra és megfogásra használjuk.", "Mosni kell étkezés előtt."]}, {word:"LÁB", category:"Testrész", difficulty:"Könnyű", hints:["Járásra használjuk.", "A cipőt erre húzzuk.", "A test alsó végtagja."]}, {word:"HAJ", category:"Testrész", difficulty:"Könnyű", hints:["A fejet borítja.", "Fodrász vágja.", "Lehet szőke, barna, fekete."]}, {word:"BŐR", category:"Szerv", difficulty:"Könnyű", hints:["A test külső borítása.", "A legnagyobb szervünk.", "Leéghet a napon."]}, {word:"ÉV", category:"Idő", difficulty:"Könnyű", hints:["365 napból áll.", "Négy évszak van benne.", "Az ember korát ebben mérik."]}, {word:"HÉT", category:"Idő", difficulty:"Könnyű", hints:["Hét napból áll.", "Munkanapokból és hétvégéből áll.", "A naptárban követhető."]}, {word:"ÉJ", category:"Napszak", difficulty:"Könnyű", hints:["A nappal ellentéte.", "Sötét van és alszunk.", "A csillagok ekkor látszanak."]},
            {word:"POR", category:"Anyag", difficulty:"Könnyű", hints:["Apró részecskék a levegőben.", "Takarítani kell.", "Allergiát okozhat."]}, {word:"SÁR", category:"Anyag", difficulty:"Könnyű", hints:["Vizes föld.", "Eső után keletkezik.", "Összekeni a cipőt."]}, {word:"VÉR", category:"Testnedv", difficulty:"Könnyű", hints:["Piros folyadék az erekben.", "Oxigént szállít.", "A szúnyog ezt szívja."]}, {word:"CSŐ", category:"Tárgy", difficulty:"Könnyű", hints:["Hosszú, üreges henger.", "Víz vagy gáz áramlik benne.", "A szerelő javítja."]}, {word:"VAS", category:"Anyag", difficulty:"Könnyű", hints:["Erős, szürke fém.", "A mágnes vonzza.", "Rozsdásodik."]}, {word:"SÖR", category:"Ital", difficulty:"Könnyű", hints:["Alkoholos ital.", "Komlóból és árpából készül.", "Habos a teteje."]}, {word:"SZÉL", category:"Időjárás", difficulty:"Könnyű", hints:["Mozgó levegő.", "A vitorlát hajtja.", "Viharban erős."]}, {word:"KÖD", category:"Időjárás", difficulty:"Könnyű", hints:["Sűrű pára a föld közelében.", "Csökkenti a látótávolságot.", "Ősszel gyakori."]},
            {word:"BARACK", category:"Gyümölcs", difficulty:"Nehéz", hints:["Lehet sárga vagy őszi.", "Szaténos vagy molyhos a héja.", "Befőttet és lekvárt is készítenek belőle."]}, {word:"KALAND", category:"Esemény", difficulty:"Nehéz", hints:["Izgalmas, szokatlan élmény.", "Indiana Jones ilyenekbe keveredik.", "A kockázat és az újdonság jellemzi."]}, {word:"REPÜLŐ", category:"Jármű", difficulty:"Nehéz", hints:["Levegőben közlekedik.", "Pilóta vezeti.", "A reptéren száll fel és le."]}, {word:"SZÍNHÁZ", category:"Épület", difficulty:"Nehéz", hints:["Előadóművészeti helyszín.", "Van színpad és nézőtér.", "Tapsviharral jutalmazzák az előadást."]}, {word:"KÓRHÁZ", category:"Intézmény", difficulty:"Nehéz", hints:["Betegeket gyógyítanak itt.", "Orvosok és ápolók dolgoznak benne.", "Látogatási idő is van."]}, {word:"TÁNYÉR", category:"Eszköz", difficulty:"Nehéz", hints:["Ebből eszünk.", "Lehet lapos vagy mély.", "A mosogatóban végzi."]}, {word:"RENDŐR", category:"Foglalkozás", difficulty:"Nehéz", hints:["A rendet felügyeli.", "Igazoltathat.", "Egyenruhát visel és jelvénye van."]}, {word:"PALOTA", category:"Épület", difficulty:"Nehéz", hints:["Nagy, díszes lakóhely.", "Régen királyok laktak benne.", "A mesékben hercegnők otthona."]}, {word:"TEKNŐS", category:"Állat", difficulty:"Nehéz", hints:["Páncélos hüllő.", "Hosszú életű.", "Lassan, megfontoltan mozog."]}, {word:"ECSET", category:"Eszköz", difficulty:"Nehéz", hints:["Festésre használják.", "A végén szőr van.", "A művész és a szobafestő is használja."]},
            {word:"HARANG", category:"Tárgy", difficulty:"Nehéz", hints:["Templomtoronyban lakik.", "Kongatják vagy húzzák.", "A déli szókor megszólal."]}, {word:"GOMBÓC", category:"Étel", difficulty:"Nehéz", hints:["Gömbölyű finomság.", "Lehet szilvás vagy túrós.", "Zsemlemorzsába forgatják."]}, {word:"SALÁTA", category:"Étel", difficulty:"Nehéz", hints:["Zöldségekből készül.", "Gyakran öntettel eszik.", "Lehet főétel vagy köret."]}, {word:"PAPUCS", category:"Lábbeli", difficulty:"Nehéz", hints:["Otthoni viselet.", "A strandolás elengedhetetlen kelléke.", "Nincs sarka, könnyű belebújni."]}, {word:"KANCSÓ", category:"Tárgy", difficulty:"Nehéz", hints:["Folyadék tárolására való edény.", "Van füle és kiöntője.", "Gyakran kerámiából készül."]}, {word:"KALÁCS", category:"Étel", difficulty:"Nehéz", hints:["Fonott kelt tészta.", "Húsvétkor népszerű.", "Lehet kakaós vagy mazsolás."]}, {word:"KEMENCE", category:"Tárgy", difficulty:"Nehéz", hints:["Hagyományos sütőalkalmatosság.", "Búbos is lehet.", "Kenyeret és langallót sütöttek benne."]}, {word:"MOTOR", category:"Jármű", difficulty:"Nehéz", hints:["Kétkerekű, motoros jármű.", "Bukósisak kötelező.", "Nagyobb és gyorsabb, mint a robogó."]}, {word:"SZOMSZÉD", category:"Személy", difficulty:"Nehéz", hints:["Mellettünk lakik.", "Átkopoghat a falon.", "Lehet jó vagy rossz a viszony vele."]}, {word:"ABLAK", category:"Nyílászáró", difficulty:"Nehéz", hints:["Kilátást biztosít.", "Üvegből készül.", "Párkánya is van."]},
            {word:"BALTA", category:"Eszköz", difficulty:"Nehéz", hints:["Favágáshoz használják.", "Éles és nehéz.", "Fejsze."]}, {word:"CSOKOR", category:"Ajándék", difficulty:"Nehéz", hints:["Vágott virágok kötege.", "Ballagáskor kapják a diákok.", "A menyasszonynak is van."]}, {word:"DINNYE", category:"Gyümölcs", difficulty:"Nehéz", hints:["Nyári, lédús finomság.", "Lehet görög vagy sárga.", "Kopogtatással ellenőrzik, hogy érett-e."]}, {word:"FARKAS", category:"Állat", difficulty:"Nehéz", hints:["Ragadozó, falkában él.", "A mesében megeszi Piroskát.", "Vonyít a holdra."]}, {word:"CERUZA", category:"Írószer", difficulty:"Nehéz", hints:["Grafittal ír.", "Radírral lehet javítani.", "Hegyezővel kell hegyezni."]}, {word:"KEDVES", category:"Tulajdonság", difficulty:"Nehéz", hints:["Barátságos, szeretetteljes.", "Az udvarias ember ilyen.", "A goromba ellentéte."]}, {word:"MÚZEUM", category:"Épület", difficulty:"Nehéz", hints:["Kiállítási tárgyakat őriz.", "Nem szabad mindent megérinteni.", "Lehet történelmi vagy szépművészeti."]}, {word:"KERTÉSZ", category:"Foglalkozás", difficulty:"Nehéz", hints:["Növényekkel foglalkozik.", "Gondozza a parkokat.", "Metszi a fákat és nyírja a füvet."]}, {word:"TAVASZ", category:"Évszak", difficulty:"Nehéz", hints:["A tél és a nyár között van.", "Rügyeznek a fák.", "Hóvirág jelzi az érkezését."]}, {word:"SZEMÜVEG", category:"Eszköz", difficulty:"Nehéz", hints:["Javítja a látást.", "Két lencséből és keretből áll.", "Az optikus készíti."]},
            {word:"CSAVAR", category:"Eszköz", difficulty:"Nehéz", hints:["Rögzítésre szolgáló alkatrész.", "Menetes a szára.", "Csavarhúzóval kell behajtani."]}, {word:"VILLÁM", category:"Jelenség", difficulty:"Nehéz", hints:["Fényjelenség viharban.", "A dörgés követi.", "Magas fába belecsaphat."]}, {word:"CSALÁD", category:"Közösség", difficulty:"Nehéz", hints:["Szülők és gyerekek.", "A legkisebb társadalmi egység.", "A vér köti össze őket."]}, {word:"UTAZÁS", category:"Cselekvés", difficulty:"Nehéz", hints:["Helyváltoztatás.", "Lehet nyaralás vagy üzleti.", "Bőröndöt kell csomagolni hozzá."]}, {word:"TELEFON", category:"Eszköz", difficulty:"Nehéz", hints:["Távolsági kommunikációra való.", "Lehet okos vagy vezetékes.", "Hívni és üzenetet küldeni lehet vele."]}, {word:"TANÁR", category:"Foglalkozás", difficulty:"Nehéz", hints:["Tudást ad át.", "Iskolában dolgozik.", "Osztályoz és feleltet."]}, {word:"RADÍR", category:"Eszköz", difficulty:"Nehéz", hints:["A ceruza nyomát tünteti el.", "Iskolaszer.", "Gyakran a ceruza végén is van."]}, {word:"PAPRIKA", category:"Növény", difficulty:"Nehéz", hints:["Lehet édes vagy csípős.", "A lecsó fontos alapanyaga.", "Őrleménye a fűszer."]}, {word:"PÁRNA", category:"Tárgy", difficulty:"Nehéz", hints:["A fejünk alá tesszük alváskor.", "Puha és kényelmes.", "Tollal vagy szivaccsal van töltve."]}, {word:"TENGER", category:"Természet", difficulty:"Nehéz", hints:["Nagy, sós vízfelület.", "Partján strandolni lehet.", "Hullámzik és áramlatai vannak."]},
            {word:"FÜZET", category:"Tárgy", difficulty:"Nehéz", hints:["Ebbe írnak a diákok.", "Lehet vonalas vagy kockás.", "Tele lehet írni."]}, {word:"KANÁL", category:"Eszköz", difficulty:"Nehéz", hints:["Evőeszköz.", "Levest eszünk vele.", "A mélyedésébe fér az étel."]}, {word:"UBORKA", category:"Növény", difficulty:"Nehéz", hints:["Zöld, hosszúkás zöldség.", "Savanyúságot készítenek belőle.", "A tzatziki alapanyaga."]}, {word:"GALAMB", category:"Állat", difficulty:"Nehéz", hints:["Városi madár.", "Békét jelképez.", "Posta."]}, {word:"PALACK", category:"Tárgy", difficulty:"Nehéz", hints:["Italokat tárolnak benne.", "A szellem lakhelye a mesékben.", "Vissza lehet váltani."]}, {word:"TÁSKA", category:"Tárgy", difficulty:"Nehéz", hints:["Dolgok szállítására való.", "Lehet hátizsák vagy kézi.", "Az iskolába is ezt viszik a gyerekek."]}, {word:"GYERTYA", category:"Tárgy", difficulty:"Nehéz", hints:["Viaszból készül, kanóccal.", "Fényt ad, ha meggyújtják.", "A tortára is tesznek belőle."]}, {word:"FESTÉK", category:"Anyag", difficulty:"Nehéz", hints:["Színezésre használják.", "A falra vagy vászonra kenik.", "Lehet olaj-, víz- vagy akril-."]}, {word:"GYŰRŰ", category:"Ékszer", difficulty:"Nehéz", hints:["Az ujjra húzzák.", "A házasság jelképe.", "Az uralkodónak pecsétes."]}, {word:"LEVÉL", category:"Kommunikáció", difficulty:"Nehéz", hints:["Postán küldik.", "A fának is van.", "Borítékban érkezik."]},
            {word:"BAJNOK", category:"Személy", difficulty:"Nehéz", hints:["Egy verseny győztese.", "Aranyérmet kap.", "A dobogó legfelső fokán áll."]}, {word:"ORVOS", category:"Foglalkozás", difficulty:"Nehéz", hints:["Betegeket gyógyít.", "Sztetoszkópot használ.", "Receptet ír fel."]}, {word:"ÁRNYÉK", category:"Jelenség", difficulty:"Nehéz", hints:["Fény hiányában jön létre.", "Követi a mozgásunkat.", "Délben a legrövidebb."]}, {word:"SZERDA", category:"Idő", difficulty:"Nehéz", hints:["A hét közepe.", "Kedd és csütörtök között van.", "A kis péntek."]}, {word:"BAJUSZ", category:"Testrész", difficulty:"Nehéz", hints:["Szőrzet az orr alatt.", "Főleg férfiak viselik.", "Salvador Dalínak jellegzetes volt."]}, {word:"GITÁR", category:"Hangszer", difficulty:"Nehéz", hints:["Pengetős hangszer.", "Általában hat húrja van.", "Lehet akusztikus vagy elektromos."]}, {word:"VÁLL", category:"Testrész", difficulty:"Nehéz", hints:["A kar és a törzs találkozása.", "Erre vesszük a táskát.", "Meg lehet rándítani."]}, {word:"SZAPPAN", category:"Tisztálkodás", difficulty:"Nehéz", hints:["Kézmosásra használjuk.", "Lehet folyékony vagy szilárd.", "Habzik a víztől."]}, {word:"LÉPCSŐ", category:"Építmény", difficulty:"Nehéz", hints:["Szintek között vezet.", "Fokozatokból áll.", "Lehet csiga- vagy mozgó-."]}, {word:"KALAP", category:"Ruhanemű", difficulty:"Nehéz", hints:["Fejfedő.", "Véd a naptól.", "Lehet cilinder vagy szalma."]},
            {word:"VÁROS", category:"Település", difficulty:"Nehéz", hints:["Nagyobb, mint a falu.", "Polgármestere van.", "Sok utca és tér van benne."]}, {word:"LEPKE", category:"Állat", difficulty:"Nehéz", hints:["Színes szárnyú rovar.", "A hernyóból fejlődik ki.", "Rászáll a virágra."]}, {word:"CSIGA", category:"Állat", difficulty:"Nehéz", hints:["Házat cipel a hátán.", "Lassan mozog.", "Eső után előbújik."]}, {word:"SZILVA", category:"Gyümölcs", difficulty:"Nehéz", hints:["Lila színű csonthéjas.", "Pálinkát is főznek belőle.", "A gombócba is teszik."]}, {word:"KÖRTE", category:"Gyümölcs", difficulty:"Nehéz", hints:["Jellegzetes alakú gyümölcs.", "Nem esik messze a fájától.", "Vilmos a leghíresebb fajtája."]}, {word:"CSAPAT", category:"Csoport", difficulty:"Nehéz", hints:["Együtt dolgoznak a győzelemért.", "Sportban és munkában is van.", "Kapitánya van."]}, {word:"FOTEL", category:"Bútor", difficulty:"Nehéz", hints:["Kényelmes, karfás szék.", "Olvasáshoz ideális.", "A tévével szemben szokott állni."]}, {word:"TÉSZTA", category:"Étel", difficulty:"Nehéz", hints:["Lisztből és tojásból készül.", "Olaszországban népszerű.", "Lehet spagetti, penne vagy lasagne."]}, {word:"SZŐNYEG", category:"Lakberendezés", difficulty:"Nehéz", hints:["A padlót borítja.", "Repülni is lehet rajta a mesékben.", "Porszívóval kell tisztítani."]}, {word:"HEGEDŰ", category:"Hangszer", difficulty:"Nehéz", hints:["Vonós hangszer.", "Négy húrja van.", "A zenekarban fontos szerepe van."]},
            {word:"VÁSZON", category:"Anyag", difficulty:"Nehéz", hints:["Erős textília.", "A festők erre festenek.", "Vitorlát is készítenek belőle."]}, {word:"FŐZELÉK", category:"Étel", difficulty:"Extra Nehéz", hints:["Sűrű, zöldséges egytálétel.", "Gyakran feltéttel eszik.", "Tipikus menzai étel."]}, {word:"BIZTOSÍTÁS", category:"Szolgáltatás", difficulty:"Extra Nehéz", hints:["Kár esetén fizet.", "Lehet kötelező vagy casco.", "Díjat kell fizetni érte."]}, {word:"VÉLEMÉNY", category:"Fogalom", difficulty:"Extra Nehéz", hints:["Személyes álláspont.", "Mindenkinek joga van hozzá.", "Lehet szubjektív vagy objektív."]}, {word:"TÁRGYALÁS", category:"Esemény", difficulty:"Extra Nehéz", hints:["Bíróságon zajlik.", "Vád és védelem.", "Az ítélettel zárul."]}, {word:"ASZTALOS", category:"Foglalkozás", difficulty:"Extra Nehéz", hints:["Fával dolgozik.", "Bútorokat készít.", "Gyalut és fűrészt használ."]}, {word:"BICIKLI", category:"Jármű", difficulty:"Extra Nehéz", hints:["Kétkerekű, emberi erővel hajtott.", "Más néven kerékpár.", "Lánc és pedál hajtja."]}, {word:"FESTMÉNY", category:"Művészet", difficulty:"Extra Nehéz", hints:["Képzőművészeti alkotás.", "Mona Lisa a leghíresebb.", "A múzeumban van kiállítva."]}, {word:"IRODALOM", category:"Művészet", difficulty:"Extra Nehéz", hints:["Írott művek összessége.", "Tanulják az iskolában.", "Műfajai a líra, epika, dráma."]}, {word:"GYÓGYSZER", category:"Termék", difficulty:"Extra Nehéz", hints:["Betegségek kezelésére szolgál.", "Patikában kapható.", "Orvosi receptre adják."]},
            {word:"POSTÁS", category:"Foglalkozás", difficulty:"Extra Nehéz", hints:["Leveleket és csomagokat kézbesít.", "Gyakran kerékpárral jár.", "Csenget, ha ajánlott küldeményt hoz."]}, {word:"PARFÜM", category:"Termék", difficulty:"Extra Nehéz", hints:["Illatosító szer.", "A testre fújják.", "Franciaország híres róla."]}, {word:"OLIMPIA", category:"Esemény", difficulty:"Extra Nehéz", hints:["Négyévente megrendezett sportverseny.", "Öt karika a szimbóluma.", "Az ókori Görögországból ered."]}, {word:"METRÓ", category:"Jármű", difficulty:"Extra Nehéz", hints:["Föld alatti vasút.", "Budapesten több vonala is van.", "Mozgólépcső visz le hozzá."]}, {word:"KARMESTER", category:"Foglalkozás", difficulty:"Extra Nehéz", hints:["Zenekart vezényel.", "Egy pálcát használ.", "A zenészek őt nézik játék közben."]}, {word:"FORRADALOM", category:"Esemény", difficulty:"Extra Nehéz", hints:["Társadalmi rend megváltoztatása.", "Magyarországon volt 1848-ban és 1956-ban.", "Gyakran fegyveres felkeléssel jár."]}, {word:"ALAPTÖRVÉNY", category:"Dokumentum", difficulty:"Extra Nehéz", hints:["Egy ország legfőbb jogszabálya.", "Régebben alkotmánynak nevezték.", "Meghatározza az állam működését."]}, {word:"SZOBRÁSZ", category:"Foglalkozás", difficulty:"Extra Nehéz", hints:["Háromdimenziós műalkotásokat készít.", "Vésőt és kalapácsot használ.", "Lehet kőből, fémből, agyagból."]}, {word:"REKLÁM", category:"Kommunikáció", difficulty:"Extra Nehéz", hints:["Termék vagy szolgáltatás népszerűsítése.", "Gyakran megszakítja a filmeket.", "Célja a vásárlásra ösztönzés."]}, {word:"EGYETEM", category:"Intézmény", difficulty:"Extra Nehéz", hints:["Felsőoktatási intézmény.", "Diplomát lehet itt szerezni.", "Karokból és tanszékekből áll."]},
            {word:"SZÓTÁR", category:"Könyv", difficulty:"Extra Nehéz", hints:["Szavak jelentését magyarázza.", "Fordításhoz elengedhetetlen.", "Lehet egy- vagy kétnyelvű."]}, {word:"PÁLYAUDVAR", category:"Épület", difficulty:"Extra Nehéz", hints:["Vonatok indulnak és érkeznek ide.", "Vágányok és peronok találhatók itt.", "Jegyiroda és váróterem is van."]}, {word:"ÜGYVÉD", category:"Foglalkozás", difficulty:"Extra Nehéz", hints:["Jogi képviseletet lát el.", "Védőbeszédet tart.", "Talárt visel a bíróságon."]}, {word:"TUDOMÁNY", category:"Terület", difficulty:"Extra Nehéz", hints:["A világ megismerésére irányuló tevékenység.", "Kísérleteken és megfigyeléseken alapul.", "Képviselői az akadémián dolgoznak."]}, {word:"RENDEZŐ", category:"Foglalkozás", difficulty:"Extra Nehéz", hints:["Filmet vagy színházi darabot irányít.", "Ő mondja, hogy 'Tessék!'.", "Instrukciókat ad a színészeknek."]}, {word:"REPÜLŐTÉR", category:"Hely", difficulty:"Extra Nehéz", hints:["Repülőgépek le- és felszállására szolgál.", "Van futópályája és terminálja.", "Más néven légikikötő."]}, {word:"MINISZTER", category:"Pozíció", difficulty:"Extra Nehéz", hints:["A kormány tagja.", "Egy adott területet (pl. oktatás) felügyel.", "Az elnök nevezi ki."]}, {word:"HŐMÉRSÉKLET", category:"Fizika", difficulty:"Extra Nehéz", hints:["A testek hőállapotát jelző mérőszám.", "Celsiusban vagy Fahrenheitben mérik.", "Hőmérővel mérik."]}, {word:"FÖLDRAJZ", category:"Tudomány", difficulty:"Extra Nehéz", hints:["A Föld felszínével foglalkozik.", "Térképeket használ.", "Domborzatot és vízrajzot is vizsgál."]}, {word:"TÖRTÉNELEM", category:"Tudomány", difficulty:"Extra Nehéz", hints:["A múlt eseményeit kutatja.", "Évszámok és csaták.", "Forráskritikát alkalmaz."]},
            {word:"VÁLLALKOZÓ", category:"Személy", difficulty:"Extra Nehéz", hints:["Saját céget alapít és vezet.", "Kockázatot vállal a profit reményében.", "Adót kell fizetnie."]}, {word:"FÉNYKÉP", category:"Tárgy", difficulty:"Extra Nehéz", hints:["A valóság egy pillanatát rögzíti.", "Fényképezőgéppel készül.", "Lehet digitális vagy papír alapú."]}, {word:"ÚJSÁGÍRÓ", category:"Foglalkozás", difficulty:"Extra Nehéz", hints:["Híreket gyűjt és cikkeket ír.", "Interjúkat készít.", "Sajtóigazolványa van."]}, {word:"ZONGORA", category:"Hangszer", difficulty:"Extra Nehéz", hints:["Billentyűs hangszer.", "Fekete és fehér billentyűi vannak.", "Kalapácsok ütik a húrokat."]}, {word:"ÁLLATKERT", category:"Hely", difficulty:"Extra Nehéz", hints:["Egzotikus állatokat mutat be.", "Ketrecekben és kifutókban tartják őket.", "A látogatók megnézhetik őket."]}, {word:"PROGRAMOZÓ", category:"Foglalkozás", difficulty:"Extra Nehéz", hints:["Számítógépes kódot ír.", "Szoftvereket és alkalmazásokat készít.", "Különböző programnyelveket használ."]}, {word:"FŐVÁROS", category:"Település", difficulty:"Extra Nehéz", hints:["Egy ország központi városa.", "Itt ülésezik a parlament.", "Magyarországon ez Budapest."]}, {word:"KARÁCSONY", category:"Ünnep", difficulty:"Extra Nehéz", hints:["Jézus születésének ünnepe.", "Ajándékozás és feldíszített fa.", "December 25-én van."]}, {word:"PÉNZTÁRCA", category:"Tárgy", difficulty:"Extra Nehéz", hints:["Pénz és kártyák tárolására való.", "Ha elveszik, nagy a baj.", "Más néven buksza."]}, {word:"KATONA", category:"Foglalkozás", difficulty:"Extra Nehéz", hints:["A hazát védi.", "Egyenruhát és fegyvert visel.", "Parancsokat teljesít."]},
            {word:"VACSORA", category:"Étel", difficulty:"Extra Nehéz", hints:["Esti étkezés.", "Az utolsó főétkezés a nap folyamán.", "Lehet könnyű vagy nehéz."]}, {word:"CSOKOLÁDÉ", category:"Édesség", difficulty:"Extra Nehéz", hints:["Kakaóbabból készült finomság.", "Svájc híres róla.", "Lehet táblás, bonbon vagy ital."]}, {word:"EBÉDLŐ", category:"Helyiség", difficulty:"Extra Nehéz", hints:["Itt zajlik a közös étkezés.", "Iskolában vagy munkahelyen.", "Más néven menza."]}, {word:"HŰTŐSZEKRÉNY", category:"Gép", difficulty:"Extra Nehéz", hints:["Élelmiszerek frissen tartására szolgál.", "Hideget csinál.", "A konyha alapvető felszerelése."]}, {word:"ÉPÍTÉSZ", category:"Foglalkozás", difficulty:"Extra Nehéz", hints:["Épületeket tervez.", "Tervrajzokat készít.", "Munkájához statikus is kell."]}, {word:"FAGYLALT", category:"Édesség", difficulty:"Extra Nehéz", hints:["Hideg, krémes nyalánkság.", "Tölcsérben árulják.", "Nyáron a legnépszerűbb."]}, {word:"KÖNYVTÁR", category:"Intézmény", difficulty:"Extra Nehéz", hints:["Könyveket kölcsönöz.", "Csendben kell lenni.", "Olvasójegy kell hozzá."]}, {word:"LÁTOGATÓ", category:"Személy", difficulty:"Extra Nehéz", hints:["Valahova vendégségbe érkezik.", "Múzeumban vagy kórházban is lehet.", "Be kell tartania a szabályokat."]}, {word:"JELENTÉS", category:"Dokumentum", difficulty:"Extra Nehéz", hints:["Beszámoló egy eseményről.", "Lehet írásbeli vagy szóbeli.", "A főnöknek kell leadni."]}, {word:"BERENDEZÉS", category:"Fogalom", difficulty:"Extra Nehéz", hints:["Egy helyiség bútorai és tárgyai.", "Lakberendező foglalkozik vele.", "A stílust is meghatározza."]}, {word:"GYŐZELEM", category:"Eredmény", difficulty:"Extra Nehéz", hints:["A verseny sikeres befejezése.", "A vereség ellentéte.", "A bajnok ezt aratja."]}
        ];

        // --- ADATOK (szerencsekerek_feladvanyok.js tartalma) ---
        const wheelPuzzles = [
            { category: "Közmondás", puzzle: "ADDIG JÁR A KORSÓ A KÚTRA AMÍG EL NEM TÖRIK" }, { category: "Film & Rendező", puzzle: "QUENTIN TARANTINO PULP FICTION" }, { category: "Élőlény", puzzle: "AZ EMBERI TEST LEGKISEBB CSILLÁMA" }, { category: "Tárgy", puzzle: "AUTOMATA NARANCSFACSARÓ GÉP" }, { category: "Fogalom", puzzle: "AZ IDŐ MINDENT MEGOLD" }, { category: "Étel & Ital", puzzle: "BÉCSI SZELET KRUMPLISALÁTÁVAL" }, { category: "Zene", puzzle: "QUEEN BOHEMIAN RHAPSODY" }, { category: "Híres Ember", puzzle: "MUNKÁCSY MIHÁLY" }, { category: "Földrajz", puzzle: "A MARIANNA ÁROK MÉLYSÉGE" }, { category: "Történelem", puzzle: "A MÁSODIK VILÁGHÁBORÚ VÉGE" }, { category: "Irodalom", puzzle: "JÓKAI MÓR AZ ARANY EMBER" }, { category: "Sport", puzzle: "PAPP LÁSZLÓ HÁROMSZOROS OLIMPIAI BAJNOK" }, { category: "Tudomány", puzzle: "ALBERT EINSTEIN RELATIVITÁSELMÉLETE" }, { category: "Márkanév", puzzle: "MERCEDES BENZ" }, { category: "Mindennapi élet", puzzle: "A BLUETOOTH CSATLAKOZTATÁSA SIKERTELEN" }, { category: "Növény", puzzle: "JAPÁN CSERESZNYEVIRÁGZÁS" }, { category: "Dalszöveg", puzzle: "AZÉRT VANNAK A JÓBARÁTOK" }, { category: "Tárgy", puzzle: "ZSEBKÉS" }, { category: "Fogalom", puzzle: "VÉGTELEN" }, { category: "Élőlény", puzzle: "KIRÁLYPINGVIN" },
            { category: "Közmondás", puzzle: "KI KORÁN KEL ARANYAT LEL" }, { category: "Közmondás", puzzle: "JOBB FÉLNI MINT MEGIJEDNI" }, { category: "Közmondás", puzzle: "SOK LÚD DISZNÓT GYŐZ" }, { category: "Közmondás", puzzle: "AJÁNDÉK LÓNAK NE NÉZD A FOGÁT" }, { category: "Közmondás", puzzle: "NEM MIND ARANY AMI FÉNYLIK" }, { category: "Közmondás", puzzle: "A SZÜKSÉG TÖRVÉNYT BONT" }, { category: "Közmondás", puzzle: "AHÁNY HÁZ ANNYI SZOKÁS" }, { category: "Közmondás", puzzle: "AKI MÁSNAK VERMET ÁS MAGA ESIK BELE" }, { category: "Közmondás", puzzle: "LASSÚ VÍZ PARTOT MOS" }, { category: "Közmondás", puzzle: "AZ ALMA NEM ESIK MESSZE A FÁJÁTÓL" },
            { category: "Film & Rendező", puzzle: "STEVEN SPIELBERG E T A FÖLDÖNKÍVÜLI" }, { category: "Irodalom", puzzle: "MOLNÁR FERENC A PÁL UTCAI FIÚK" }, { category: "Zene", puzzle: "LGT A KICSI A NAGY AZ ARTÚR ÉS AZ INDIÁN" }, { category: "Híres Ember", puzzle: "PETŐFI SÁNDOR" }, { category: "Földrajz", puzzle: "A DUNA EURÓPA MÁSODIK LEGHOSSZABB FOLYÓJA" }, { category: "Történelem", puzzle: "A MAGYAR HONFOGLALÁS" }, { category: "Tudomány", puzzle: "A DNS KETTŐS SPIRÁL SZERKEZETE" }, { category: "Étel & Ital", puzzle: "GULYÁSLEVES CSIPETKÉVEL" }, { category: "Élőlény", puzzle: "KÉK BÁLNA A LEGNAGYOBB EMLŐS" }, { category: "Növény", puzzle: "TÖLGYFA" }, { category: "Tárgy", puzzle: "OKOSTELEFON TÖLTŐKÁBEL" }, { category: "Sport", puzzle: "OLIMPIAI JÁTÉKOK" }, { category: "Márkanév", puzzle: "COCA COLA" }, { category: "Mindennapi élet", puzzle: "HOLNAP REGGEL KORÁN KELL KELNEM" }, { category: "Fogalom", puzzle: "A SZABADSÁG ÉS A SZERELEM" }, { category: "Foglalkozás", puzzle: "TŰZOLTÓ" }, { category: "Csillagászat", puzzle: "TEJÚTRENDSZER" }
        ];

        // --- KONSTANSOK ÉS VÁLTOZÓK ---
        const MAX_GUESSES = 6; let gameData = {}; let timerInterval; let cooldownIntervals = {}; let hintDisplayTimeout = null; let wheelMessageTimeout = null; let randomMessageInterval = null;
        const SIX_HOURS_IN_MS = 6 * 60 * 60 * 1000;
        const RETRY_COOLDOWN_MS = 15 * 60 * 1000;
        
        // DOM Elemek
        const body = document.body;
        const gridContainer = document.getElementById('grid-container'); const keyboardContainer = document.getElementById('keyboard-container'); const requestTextHintButton = document.getElementById('request-text-hint-button'); const requestLetterHintButton = document.getElementById('request-letter-hint-button'); const wordTrackerContainer = document.getElementById('word-tracker'); const unlockBonusButton = document.getElementById('unlock-bonus-button'); const dailyScoreDisplaySpan = document.querySelector('#daily-score-display span'); const newSetOverlay = document.getElementById('new-set-overlay'); const refreshButton = document.getElementById('refresh-button');
        const wheelGameOverlay = document.getElementById('wheel-game-overlay'); const closeWheelButton = document.getElementById('close-wheel-button'); const wheel = document.getElementById('wheel'); const spinButton = document.getElementById('spin-button'); const powerMeterBar = document.getElementById('power-meter-bar'); const powerMeterContainer = document.getElementById('power-meter-container'); const playerScoreEl = document.getElementById('player-score'); const stakeAmountEl = document.getElementById('stake-amount'); const puzzleBoardEl = document.getElementById('puzzle-board'); const puzzleCategoryEl = document.getElementById('puzzle-category'); const solveButton = document.getElementById('solve-button'); const wheelMessageDisplay = document.getElementById('wheel-message-display');
        const wheelRoundDisplay = document.getElementById('wheel-round-display'); const wheelDecisionControls = document.getElementById('wheel-decision-controls'); const cashOutButton = document.getElementById('cash-out-button'); const nextRoundButton = document.getElementById('next-round-button'); const themeToggleButton = document.getElementById('theme-toggle-button'); const themePicker = document.getElementById('theme-picker');
        const infoBar = document.getElementById('info-bar'); const hintDisplayArea = document.getElementById('hint-display-area'); const idleMessageContainer = document.getElementById('idle-message-container'); const hintControls = document.getElementById('hint-controls');
        const wheelAlphabetPanel = document.getElementById('wheel-alphabet-panel');
        
        const themes = [ { name: "Klasszikus", className: "theme-classic", color: "#3d405b" }, { name: "Erdei", className: "theme-forest", color: "#2d6a4f" }, { name: "Óceán", className: "theme-ocean", color: "#0077b6" }, { name: "Naplemente", className: "theme-sunset", color: "#f77f00" }, { name: "Éjszakai", className: "theme-night", color: "#232526" }, { name: "Rózsa", className: "theme-rose", color: "#c9184a" }, { name: "Vintage", className: "theme-vintage", color: "#a27b5c" }, { name: "Rét", className: "theme-meadow", color: "#7cb518" }, { name: "Királyi", className: "theme-royal", color: "#5a189a" }, { name: "Hacker", className: "theme-hacker", color: "#00ff00" } ];
        const KEY_LAYOUT = [ ['Q', 'W', 'E', 'R', 'T', 'Z', 'U', 'I', 'O', 'P', 'Ö', 'Ü', 'Ó'], ['A', 'S', 'D', 'F', 'G', 'H', 'J', 'K', 'L', 'É', 'Á', 'Ű'], ['Enter', 'Y', 'X', 'C', 'V', 'B', 'N', 'M', 'Í', 'Backspace'] ];
        const wheelSegmentsR1 = [ { label: '500', value: 500, color: '#a5d6a7' }, { label: 'CSŐD', value: 'bankrupt', color: 'var(--fail-color)' }, { label: '750', value: 750, color: '#b39ddb' }, { label: '1000', value: 1000, color: '#f2cc8f' }, { label: '250', value: 250, color: '#a5d6a7' }, { label: '1500', value: 1500, color: '#81b29a' }, { label: '500', value: 500, color: '#b39ddb' }, { label: '2000', value: 2000, color: '#e07a5f' }];
        const wheelSegmentsR2 = [ { label: '1000', value: 1000, color: '#a5d6a7' }, { label: 'FELEZŐ', value: 'half', color: '#f57c00' }, { label: '1500', value: 1500, color: '#b39ddb' }, { label: '2500', value: 2500, color: '#f2cc8f' }, { label: '750', value: 750, color: '#a5d6a7' }, { label: 'CSŐD', value: 'bankrupt', color: 'var(--fail-color)' }, { label: '3000', value: 3000, color: '#81b29a' }, { label: '5000', value: 5000, color: '#e07a5f' }];
        const wheelSegmentsR3 = [ { label: '5000', value: 5000, color: '#a5d6a7' }, { label: 'CSŐD', value: 'bankrupt', color: 'var(--fail-color)' }, { label: '7500', value: 7500, color: '#b39ddb' }, { label: 'FELEZŐ', value: 'half', color: '#f57c00' }, { label: '10000', value: 10000, color: '#81b29a' }, { label: 'CSŐD', value: 'bankrupt', color: 'var(--fail-color)' }, { label: '15000', value: 15000, color: '#f2cc8f' }, { label: '25000', value: 25000, color: '#e07a5f' }];
        const wheelSegmentSets = [null, wheelSegmentsR1, wheelSegmentsR2, wheelSegmentsR3];
        let wheelState = {};
        const FULL_ALPHABET = "AÁBCDEÉFGHIÍJKLMNOÓÖŐPQRSTUÚÜŰVXYZ";
        const VOWELS = "AÁEÉIÍOÓÖŐUÚÜŰ";
        
        const BONUS_REMINDER_MESSAGES = [
            { title: "A nyomozás szünetel...", text: "Minden nyomot felderítettél! Oldd fel a bónusz játékot a Szerencsekerék gombbal a nagyobb nyereményért, vagy várj a következő óráig az új kihívásokért!" },
            { title: "Minden szál elvarrva", text: "Kiváló munka, minden rejtély megoldva! Most jöhet a Szerencsekerék, vagy egy kávészünet a következő ügyig?" },
        ];
        
        const FUNNY_IDLE_MESSAGES = [
            { title: "Türelmi idő", text: "A gyanúsítottak kihallgatása folyamatban... Az informátorunk a következő órában jelentkezik újabb nyomokkal." },
            { title: "Kávészünet a rendőrsön", text: "Még a legjobb nyomozóknak is jár egy fánk. Amíg eszel, a laborosok elemzik a bizonyítékokat. Jöjj vissza egy óra múlva!" },
            { title: "Várakozás a sötét sikátorban", text: "Árnyékba húzódtál, és a kapcsolatodra vársz. Azt súgta, egy órán belül érkezik a következő fülessel." },
            { title: "Akták rendezése", text: "Annyi ügyet megoldottál, hogy a főnök megkért, legalább egy óráig rakj rendet az irodádban. A papírmunka a legkeményebb dió." },
            { title: "Lehallgatás alatt", text: "Egy poloskát telepítettél a bűnözők búvóhelyére. Most nincs más hátra, mint várni. Egy órán belül biztosan mondanak valami érdekeset." },
            { title: "Álruha tesztelése", text: "A következő ügyhöz tökéletes álca kell. A bajuszragasztó egy óráig szárad. Addig is, gyakorold a mély hangot." },
            { title: "Nagyító tisztítása", text: "Egy jó detektív eszközei mindig patyolattiszták. Az apró betűs részhez elengedhetetlen. A következő órában új nyomok után kutathatsz." },
            { title: "A forró nyom kihűlt", text: "Úgy tűnik, zsákutcába jutottál. De ne csüggedj, a bűnözők hibázni fognak! A következő órában újabb esélyt kapsz." },
            { title: "Rejtvényfejtés a fotelben", text: "Mint a legnagyobb detektívek, te is az agyadat használod. Dőlj hátra, és gondolkodj! A megoldás egy órán belül beugrik." },
            { title: "Tanúvédelem", text: "A koronatanút biztonságos helyre szállítottad. Most egy órád van, amíg a helyzet lecsillapodik, és újra akcióba léphetsz." },
            { title: "Ujjlenyomatok elemzése", text: "A labor per pillanat túlterhelt. Az eredményekre legalább egy órát várni kell. Addig is, igyál egy kávét, megérdemled." },
            { title: "A nagy hal kapásra vár", text: "A csali kint van, a háló kivetve. Most már csak türelem kell. Egy órán belül a legnagyobb bűnöző is a kezeid közé kerülhet." }
        ];

        const RANDOM_GAME_MESSAGES = [ "Ez az ügy keményebb, mint a kétnapos zsemle.", "Minden betű egy újabb nyom.", "A megérzésem azt súgja, jó úton jársz.", "Lassan összeáll a kép, mint egy puzzle.", "Csak egy hajszál választ el a megoldástól.", "Figyelj a részletekre, a tettes mindig hibázik.", "Ez a szó rejtélyesebb, mint egy lezárt akta.", "Kövesd a betűk nyomát!", "A logika a legjobb fegyvered.", "Minden tipp egy lépés a megoldás felé.", "Nincs megoldhatatlan ügy, csak kevés információ.", "Olyan ez, mint egy kódolt üzenet.", "Látom a fényt az alagút végén... vagy csak egy lámpa?", "A gyanúsítottak köre szűkül.", "Még egy-két betű, és lezárhatjuk az aktát.", "Az igazság odaát van... a billentyűzeteden.", "A bizonyítékok magukért beszélnek.", "Ne add fel, a főnyom a szemed előtt lehet!", "Ez a rejtvény próbára teszi a szürkeállományt.", "A csend néha a leghangosabb vallomás.", "Minden rossz tipp egy zsákutca.", "Az alibid ingatag, de a tipped talán nem az.", "Járj a dolgok végére, detektív!", "A türelem meghozza a betűjét.", "Ez a szó ártatlannak tűnik, de csalóka.", "Minden karakter számít.", "A nagyító alatt minden kiderül.", "A megoldás egyszerűbb, mint gondolnád. Vagy nem.", "Az idő ellened dolgozik, de a tudás veled van.", "A tettes nevét betűkből kell kirakni.", "Egy igazi mesterdetektív sosem adja fel.", "A gyanú árnyéka minden betűre rávetül.", "Ez az eset annyira csavaros, mint egy telefonkábel.", "A megoldás kulcsa a következő leütésben rejlik.", "Nézz a szavak mögé!", "A lexikon a legjobb informátorod.", "Ezt az ügyet még a főnök is nehéznek találná.", "A betűk erdejében kell megtalálni a helyes utat.", "Ne hagyd, hogy egy rossz tipp eltérítsen!", "A véletlenekben nem hiszünk, csak a nyomokban.", "Minden egyes tipp egy kihallgatás.", "A betűk, mint a tanúk, néha hazudnak.", "A megoldás egy karnyújtásnyira van.", "A koncentráció a siker záloga.", "Egy utolsó erőfeszítés, és megvan!", "Az ügy megoldása közelebb van, mint gondolnád.", "A rejtély hamarosan megoldódik.", "A nyomozás a tetőfokára hág.", "Ez a rejtély nem adja magát könnyen.", "A tettes egyre idegesebb, érzi, hogy a nyomában vagy." ];

        const WHEEL_MESSAGES = {
            start_round: [ "Kezdődjön a kör!", "Új feladvány, új esély!", "Lássuk, mit tudsz!", "Mutasd meg a tudásod!", "Sok szerencsét a következő körhöz!" ],
            spin_prompt: [ "Pörgess egy nagyot!", "Jöhet a pörgetés!", "Lássuk, mit dob a gép!", "Sorsfordító pörgetés következik!", "Mutasd, mit ér a szerencséd!" ],
            spin_result: [ "A kerék {value} ponton állt meg!", "A szerencse {value} pontot hozott!", "Eredmény: {value} pont!", "Szép pörgetés: {value}!", "{value} a jutalmad!" ],
            guess_consonant: [ "Válassz egy mássalhangzót!", "Melyik mássalhangzóra tippelsz?", "Jöhet egy mássalhangzó!", "Most egy mássalhangzóval teheted próbára magad.", "Mássalhangzót, de gyorsan!" ],
            guess_vowel: [ "Melyik magánhangzóra esik a választásod?", "Vegyél egy magánhangzót!", "Jöhet egy magánhangzó 250 pontért!", "Melyik magánhangzó hiányzik?" ],
            correct_guess: [ "Ez telitalálat!", "Tökéletes tipp!", "Benne van!", "Eltaláltad!", "Pontosan!", "Kiváló megfigyelés!", "Ez az!" ],
            wrong_guess: [ "Sajnos ez nincs benne.", "Ez a betű most nem segített.", "Nem jártál szerencsével.", "Rossz tipp, de ne add fel!", "Ez most mellément." ],
            bankrupt: [ "Ó, ne! Csőd!", "A bank mindent visz!", "Lenulláztad a körös nyereményed!", "Ez fájni fog... CSŐD!", "Sajnos a csődre pörgettél." ],
            half: [ "Felező! A teljes nyereményed megcsappant.", "A felező lecsapott!", "Ajaj, a nyeremény fele elúszott.", "Felező! Óvatosan a következő pörgetéssel!" ],
            solve_success: [ "Hihetetlen! Helyes a megfejtés!", "Gratulálunk, zseniális vagy!", "Megcsináltad! Tiéd a nyeremény!", "Le a kalappal, ez a helyes megoldás!" ],
            solve_fail: [ "Sajnos ez nem a helyes megfejtés. A játék véget ért.", "Ez most nem jött össze. Elbuktad a tétet.", "Rossz válasz. A nyeremény elszállt." ],
            cash_out: [ "Okos döntés! A nyeremény a zsebedben.", "Gratulálunk a nyereményedhez!", "Szép volt! Ezt már senki sem veheti el tőled." ],
            next_round: [ "Jöhet a következő, nehezebb kör!", "A java még csak most jön!", "Duplázzuk a téteket? Jöhet a következő kör!" ],
            not_enough_points: [ "Nincs elég pontod magánhangzót venni!", "Ehhez több pontra lesz szükséged!", "Sajnos a kassza üres egy magánhangzóhoz." ]
        };

        // --- TÉMA VÁLASZTÓ LOGIKA ---
        function populateThemePicker() { themes.forEach(theme => { const swatch = document.createElement('div'); swatch.className = 'theme-swatch'; swatch.title = theme.name; swatch.style.backgroundColor = theme.color; swatch.dataset.theme = theme.className; themePicker.appendChild(swatch); }); }
        function applyTheme(themeClassName) { body.className = ''; body.classList.add(themeClassName); document.querySelectorAll('.theme-swatch').forEach(s => s.classList.remove('active')); const activeSwatch = document.querySelector(`.theme-swatch[data-theme="${themeClassName}"]`); if(activeSwatch) activeSwatch.classList.add('active'); }
        function saveTheme(themeClassName) { localStorage.setItem('szonyomozo_theme', themeClassName); }
        function loadTheme() { const savedTheme = localStorage.getItem('szonyomozo_theme') || 'theme-classic'; applyTheme(savedTheme); }
        themeToggleButton.addEventListener('click', (e) => { e.stopPropagation(); themePicker.style.display = themePicker.style.display === 'flex' ? 'none' : 'flex'; });
        themePicker.addEventListener('click', (e) => { if (e.target.classList.contains('theme-swatch')) { const themeClassName = e.target.dataset.theme; applyTheme(themeClassName); saveTheme(themeClassName); } });
        document.addEventListener('click', (e) => { if (!themePicker.contains(e.target) && !themeToggleButton.contains(e.target)) { themePicker.style.display = 'none'; } });
        
        // --- SZERENCSEKERÉK FÜGGVÉNYEK ---
        function showWheelMessage(category, options = {}) { clearTimeout(wheelMessageTimeout); const messages = WHEEL_MESSAGES[category] || ["Hiba: Ismeretlen üzenet kategória."]; let message = messages[Math.floor(Math.random() * messages.length)]; if (options.value) { message = message.replace('{value}', `<strong>${options.value}</strong>`); } wheelMessageDisplay.innerHTML = message; wheelMessageDisplay.style.opacity = 1; wheelMessageTimeout = setTimeout(() => { wheelMessageDisplay.style.opacity = 0; }, options.duration || 4000); }
        function drawWheel(round) { wheel.innerHTML = ''; const segments = wheelSegmentSets[round]; const numSegments = segments.length; const angleStep = 360 / numSegments; const radius = 50; for (let i = 0; i < numSegments; i++) { const segment = segments[i]; const startAngle = i * angleStep; const endAngle = (i + 1) * angleStep; const start = polarToCartesian(radius, radius, radius, endAngle); const end = polarToCartesian(radius, radius, radius, startAngle); const largeArcFlag = endAngle - startAngle <= 180 ? "0" : "1"; const d = `M ${start.x} ${start.y} A ${radius} ${radius} 0 ${largeArcFlag} 0 ${end.x} ${end.y} L ${radius} ${radius} Z`; const path = document.createElementNS("http://www.w3.org/2000/svg", "path"); path.setAttribute("d", d); path.setAttribute("fill", segment.color); wheel.appendChild(path); const textAngle = startAngle + angleStep / 2; const textPos = polarToCartesian(radius, radius, radius * 0.7, textAngle); const text = document.createElementNS("http://www.w3.org/2000/svg", "text"); text.setAttribute("x", textPos.x); text.setAttribute("y", textPos.y); text.setAttribute("text-anchor", "middle"); text.setAttribute("dominant-baseline", "middle"); text.setAttribute("font-size", "7"); text.setAttribute("font-weight", "bold"); text.setAttribute("fill", "white"); text.setAttribute("transform", `rotate(${textAngle + 90} ${textPos.x} ${textPos.y})`); text.textContent = segment.label; wheel.appendChild(text); } }
        function polarToCartesian(cx, cy, r, angle) { const rad = (angle - 90) * Math.PI / 180.0; return { x: cx + (r * Math.cos(rad)), y: cy + (r * Math.sin(rad)) }; }
        function initWheelGame() { let stake = 0; const currentScore = getDailyScore(); while (true) { const stakeInput = prompt(`Mennyi pontot szeretnél kockáztatni a Szerencsekeréken? (Jelenlegi pontszám: ${currentScore})`, "100"); if (stakeInput === null) { return; } stake = parseInt(stakeInput); if (!isNaN(stake) && stake > 0 && stake <= currentScore) { break; } alert("Érvénytelen tét! Kérlek, a pontjaidnál nem nagyobb, pozitív számot adj meg."); } addPointsToDailyScore(-stake); gameData.bonusPlayed = true; saveGame(); unlockBonusButton.disabled = true; unlockBonusButton.classList.remove('pulse', 'unlocked'); wheelState = { currentRound: 0, totalWinnings: 0, initialStake: stake, roundScore: 0, spinResult: null, isSpinning: false, isPoweringUp: false, guessedLetters: [] }; stakeAmountEl.textContent = stake; startNewRound(); wheelGameOverlay.classList.add('visible'); checkAndDisplayIdleState(); }
        function startNewRound() { wheelState.currentRound++; wheelState.guessedLetters = []; wheelState.roundScore = 0; wheelRoundDisplay.textContent = `${wheelState.currentRound}. KÖR`; const availablePuzzles = wheelPuzzles.filter(p => !p.used); if (availablePuzzles.length === 0) { wheelPuzzles.forEach(p => p.used = false); } const puzzleIndex = Math.floor(Math.random() * availablePuzzles.length); wheelState.puzzle = availablePuzzles[puzzleIndex]; availablePuzzles[puzzleIndex].used = true; drawWheel(wheelState.currentRound); setupPuzzleBoard(); createAlphabetPanel(); updateUIForGameState('start_round'); showWheelMessage('start_round'); }
        function createAlphabetPanel() { wheelAlphabetPanel.innerHTML = ''; FULL_ALPHABET.split('').forEach(letter => { const key = document.createElement('button'); key.className = 'alphabet-key'; key.textContent = letter; key.dataset.letter = letter; if (VOWELS.includes(letter)) { key.classList.add('vowel'); key.title = "Magánhangzó (250 pont)"; } else { key.title = "Mássalhangzó"; } key.addEventListener('click', () => handleAlphabetClick(letter)); wheelAlphabetPanel.appendChild(key); }); }
        function handleAlphabetClick(letter) { if (wheelState.isSpinning || wheelState.guessedLetters.includes(letter)) return; if (VOWELS.includes(letter)) { if (wheelState.totalWinnings < 250) { showWheelMessage('not_enough_points'); return; } if (confirm("Biztosan veszel egy magánhangzót 250 pontért?")) { guessLetter(letter); } } else { if (wheelState.spinResult > 0) { guessLetter(letter); } else { showWheelMessage('spin_prompt'); } } }
        function updateAlphabetPanel() { wheelState.guessedLetters.forEach(letter => { const key = wheelAlphabetPanel.querySelector(`[data-letter="${letter}"]`); if(key) key.classList.add('guessed'); }); }
        function setupPuzzleBoard() { puzzleBoardEl.innerHTML = ''; puzzleCategoryEl.textContent = wheelState.puzzle.category; const puzzleText = wheelState.puzzle.puzzle; for(const char of puzzleText) { const tile = document.createElement('div'); if (char === ' ') { tile.className = 'puzzle-tile space'; } else { tile.className = 'puzzle-tile'; tile.innerHTML = `<div class="tile-inner"><div class="tile-face tile-front"></div><div class="tile-face tile-back">${char}</div></div>`; tile.dataset.letter = char.toUpperCase(); } puzzleBoardEl.appendChild(tile); } }
        function togglePowerMeterAndSpin() { if (wheelState.isSpinning) return; if (!wheelState.isPoweringUp) { showWheelMessage('Állítsd be az erősséget, majd kattints újra!'); wheelState.isPoweringUp = true; powerMeterBar.classList.add('power-up'); } else { wheelState.isPoweringUp = false; const power = powerMeterBar.offsetWidth / powerMeterContainer.offsetWidth; powerMeterBar.classList.remove('power-up'); spinWheel(power); } }
        function spinWheel(power) { wheelState.isSpinning = true; updateUIForGameState('spinning'); showWheelMessage('Pörög a kerék...'); const baseRotations = 3; const randomExtra = Math.random(); const powerRotation = 2 * power; const totalRotation = (baseRotations + randomExtra + powerRotation) * 360; const currentRotation = parseFloat(wheel.dataset.rotation || 0); const newRotation = currentRotation + totalRotation; wheel.style.transform = `rotate(${newRotation}deg)`; wheel.dataset.rotation = newRotation; setTimeout(() => { const finalAngle = newRotation % 360; const segments = wheelSegmentSets[wheelState.currentRound]; const segmentAngle = 360 / segments.length; const segmentIndex = Math.floor((360 - finalAngle % 360) / segmentAngle) % segments.length; handleSpinResult(segments[segmentIndex].value); }, 4000); }
        function handleSpinResult(result) { wheelState.isSpinning = false; if (result === 'bankrupt') { loseGame(null); } else if (result === 'half') { wheelState.totalWinnings = Math.floor(wheelState.totalWinnings / 2); updateWheelPlayerScore(); showWheelMessage('half'); updateUIForGameState('start_round'); } else { wheelState.spinResult = result; updateUIForGameState('guess_consonant'); showWheelMessage('spin_result', { value: result }); showWheelMessage('guess_consonant', {duration: 6000}); } }
        function guessLetter(letter) { letter = letter.toUpperCase(); wheelState.guessedLetters.push(letter); if (VOWELS.includes(letter)) { wheelState.totalWinnings -= 250; } let foundCount = 0; document.querySelectorAll(`.puzzle-tile[data-letter="${letter}"]`).forEach(tile => { if(!tile.classList.contains('revealed')) {tile.classList.add('revealed'); foundCount++;} }); if (foundCount > 0) { if (!VOWELS.includes(letter)) { let pointsEarned = foundCount * wheelState.spinResult; wheelState.roundScore += pointsEarned; wheelState.totalWinnings += pointsEarned; } showWheelMessage('correct_guess'); } else { showWheelMessage('wrong_guess'); } updateWheelPlayerScore(); updateAlphabetPanel(); updateUIForGameState('start_round'); checkWheelWin(); }
        function solve() { const solution = prompt("Kérlek, add meg a teljes megfejtést:"); if (solution === null) { return; } if (solution.toUpperCase().trim().replace(/\s+/g, ' ') === wheelState.puzzle.puzzle.toUpperCase()) { showWheelMessage('solve_success'); document.querySelectorAll('.puzzle-tile[data-letter]').forEach(tile => tile.classList.add('revealed')); updateUIForGameState('puzzle_solved'); } else { loseGame(wheelState.puzzle.puzzle); } }
        function loseGame(correctAnswer) { wheelState.totalWinnings = 0; wheelState.roundScore = 0; if(correctAnswer) { showWheelMessage('solve_fail', {duration: 6000}); updateUIForGameState('game_over'); } else { showWheelMessage('bankrupt'); updateUIForGameState('start_round'); } updateWheelPlayerScore(); }
        function cashOut() { showWheelMessage('cash_out', {duration: 5000}); addPointsToDailyScore(wheelState.totalWinnings + wheelState.initialStake); updateUIForGameState('game_over'); }
        function updateWheelPlayerScore() { playerScoreEl.textContent = wheelState.totalWinnings; }
        function updateUIForGameState(state) { const controls = document.getElementById('wheel-controls'); controls.style.display = 'none'; wheelDecisionControls.style.display = 'none'; closeWheelButton.style.display = 'none'; spinButton.disabled = true; solveButton.disabled = true; powerMeterContainer.style.pointerEvents = 'none'; if (state === 'start_round' || state === 'guess_consonant') { controls.style.display = 'flex'; spinButton.disabled = false; powerMeterContainer.style.pointerEvents = 'auto'; solveButton.disabled = false; wheelState.spinResult = (state === 'start_round') ? 0 : wheelState.spinResult; } else if (state === 'spinning') { controls.style.display = 'flex'; } else if (state === 'puzzle_solved') { if (wheelState.currentRound < 3) { wheelDecisionControls.style.display = 'flex'; showWheelMessage('next_round'); } else { showWheelMessage("Ez volt az utolsó kör! A nyereményed a tiéd!", 5000); cashOut(); } } else if (state === 'game_over') { closeWheelButton.style.display = 'block'; } }
        function checkWheelWin() { const allTiles = document.querySelectorAll('.puzzle-tile[data-letter]'); const revealedTiles = document.querySelectorAll('.puzzle-tile.revealed[data-letter]'); if(allTiles.length > 0 && allTiles.length === revealedTiles.length) { updateUIForGameState('puzzle_solved'); } }
        
        // --- FŐ JÁTÉKLOGIKA ---
        function checkDailyReset() { const today = new Date().toDateString(); let stats = JSON.parse(localStorage.getItem('szonyomozo_daily_stats')); if (!stats || stats.lastResetDate !== today) { stats = { totalScore: 200, lastResetDate: today }; localStorage.setItem('szonyomozo_daily_stats', JSON.stringify(stats)); localStorage.removeItem('szonyomozo_word_history'); } updateDailyScoreDisplay(stats.totalScore); }
        function getDailyScore() { const stats = JSON.parse(localStorage.getItem('szonyomozo_daily_stats')); return stats ? stats.totalScore : 0; }
        function addPointsToDailyScore(points) { let stats = JSON.parse(localStorage.getItem('szonyomozo_daily_stats')); stats.totalScore = Math.max(0, stats.totalScore + points); localStorage.setItem('szonyomozo_daily_stats', JSON.stringify(stats)); updateDailyScoreDisplay(stats.totalScore); }
        function updateDailyScoreDisplay(score) { dailyScoreDisplaySpan.textContent = score; }
        function getAvailableWordIndices() { let history = JSON.parse(localStorage.getItem('szonyomozo_word_history')) || []; const now = Date.now(); history = history.filter(entry => now - entry.timestamp < SIX_HOURS_IN_MS); localStorage.setItem('szonyomozo_word_history', JSON.stringify(history)); const usedIndices = new Set(history.map(entry => entry.index)); const allIndices = Array.from(Array(wordData.length).keys()); return allIndices.filter(index => !usedIndices.has(index)); }
        function addWordsToHistory(indices) { let history = JSON.parse(localStorage.getItem('szonyomozo_word_history')) || []; const now = Date.now(); indices.forEach(index => history.push({ index, timestamp: now })); localStorage.setItem('szonyomozo_word_history', JSON.stringify(history)); }
        function initGame() { checkDailyReset(); const hourSeed = getCurrentHourSeed(); const storedData = JSON.parse(localStorage.getItem('szonyomozo_progress')); if (storedData && storedData.seed === hourSeed) { gameData = storedData; } else { gameData = { seed: hourSeed, hourlySet: [], progress: [], timers: {}, gameModes: {}, revealedIndices: {}, revealedHints: {}, bonusPlayed: false, currentWordIndex: 0, currentRow: 0, currentCol: 0, isGameOver: false }; const availableIndices = getAvailableWordIndices(); let chosenIndices = []; for (let i = 0; i < 5; i++) { if(availableIndices.length === 0) { console.warn("Elfogyott a 6 órán belül nem használt szó. Ismétlődés lehetséges."); const allIndices = Array.from(Array(wordData.length).keys()); availableIndices.push(...allIndices); } const randomIndex = Math.floor(seededRandom(hourSeed + i * 13) * availableIndices.length); chosenIndices.push(availableIndices.splice(randomIndex, 1)[0]); } gameData.hourlySet = chosenIndices; addWordsToHistory(chosenIndices); gameData.progress = Array(5).fill(null).map(() => ({status: 'pending', scored: false})); gameData.timers = Array(5).fill(180); gameData.gameModes = Array(5).fill('relax'); gameData.revealedIndices = {}; gameData.revealedHints = {}; gameData.bonusPlayed = false; for(let i=0; i<5; i++) { gameData.revealedIndices[i] = []; gameData.revealedHints[i] = { text: [], usedCount: 0 }; } gameData.currentWordIndex = 0; saveGame(); } renderWordTracker(); if (!checkAndDisplayIdleState()) { loadWord(gameData.currentWordIndex); } checkForBonusGameUnlock(); }
        function loadWord(indexInSet) { if(indexInSet >= gameData.hourlySet.length) return; clearInterval(timerInterval); clearInterval(randomMessageInterval); clearTimeout(hintDisplayTimeout); hintDisplayArea.classList.remove('active'); Object.values(cooldownIntervals).forEach(clearInterval); cooldownIntervals = {}; gameData.currentWordIndex = indexInSet; const wordProgress = gameData.progress[indexInSet].status; gameData.isGameOver = (wordProgress !== 'pending'); gameData.currentRow = 0; gameData.currentCol = 0; renderInfoBarFront(); initializeGrid(wordData[gameData.hourlySet[indexInSet]].word.length); initializeKeyboard(); renderWordTracker(); updateHintButtons(); if (gameData.isGameOver) { keyboardContainer.classList.add('disabled'); showEndMessage(); } else { keyboardContainer.classList.remove('disabled'); startRandomMessageTimer(); } }
        function submitGuess() { const wordObject = wordData[gameData.hourlySet[gameData.currentWordIndex]]; if (gameData.currentCol !== wordObject.word.length) return; const guess = Array.from(document.getElementById(`row-${gameData.currentRow}`).children).map(cell => cell.querySelector('.cell-front').textContent).join(''); if (guess.length !== wordObject.word.length) return; flipRow(guess, wordObject.word.toUpperCase()); if (guess === wordObject.word.toUpperCase()) { gameData.isGameOver = true; clearInterval(timerInterval); clearInterval(randomMessageInterval); if(!gameData.progress[gameData.currentWordIndex].scored) { let points = wordObject.word.length * 50 + (wordObject.difficulty === "Nehéz" ? 50 : (wordObject.difficulty === "Extra Nehéz" ? 100 : 0)); if (gameData.gameModes[gameData.currentWordIndex] === 'timed') { points = Math.round(points * 1.5); } addPointsToDailyScore(points); showFeedbackMessage(`Helyes! +${points} pont!`); gameData.progress[gameData.currentWordIndex].scored = true; } gameData.progress[gameData.currentWordIndex].status = 'solved'; keyboardContainer.classList.add('disabled'); requestTextHintButton.disabled = true; requestLetterHintButton.disabled = true; setTimeout(() => { checkForBonusGameUnlock(); saveGame(); renderWordTracker(); checkAndDisplayIdleState(); }, 2500); } else { gameData.currentRow++; if (gameData.currentRow >= MAX_GUESSES) { clearInterval(timerInterval); clearInterval(randomMessageInterval); failWord(); } else { gameData.currentCol = 0; } } saveGame(); }
        function calculateHintCost(isLetterHint = false) { const wordObject = wordData[gameData.hourlySet[gameData.currentWordIndex]]; let baseCost; switch (wordObject.difficulty) { case "Könnyű": baseCost = 25; break; case "Nehéz": baseCost = 50; break; case "Extra Nehéz": baseCost = 75; break; default: baseCost = 25; } const hintsUsed = gameData.revealedHints[gameData.currentWordIndex].usedCount; const costMultiplier = hintsUsed >= 2 ? 2 : 1; const letterMultiplier = isLetterHint ? 1.5 : 1; return Math.round(baseCost * costMultiplier * letterMultiplier); }
        function spendPointsForHint(isLetterHint = false) { const cost = calculateHintCost(isLetterHint); const currentScore = getDailyScore(); if (currentScore < cost) { alert(`Nincs elég pontod! A segítség ${cost} pontba kerül, de neked csak ${currentScore} pontod van.`); return false; } if (confirm(`Biztosan elköltesz ${cost} pontot a segítségért?`)) { addPointsToDailyScore(-cost); return true; } return false; }
        
        // --- SEGÉD- ÉS RENDERELŐ FÜGGVÉNYEK ---
        function saveGame() { localStorage.setItem('szonyomozo_progress', JSON.stringify(gameData)); }
        function renderWordTracker() { wordTrackerContainer.innerHTML = ''; gameData.hourlySet.forEach((_, index) => { const item = document.createElement('div'); item.className = 'tracker-item'; item.dataset.index = index; const progress = gameData.progress[index]; if (progress.status === 'solved') { item.classList.add('solved'); item.textContent = `${index + 1}. szó`; } else if (progress.status === 'failed' && progress.failTimestamp) { item.classList.add('failed'); const remainingTime = progress.failTimestamp + RETRY_COOLDOWN_MS - Date.now(); if (remainingTime > 0) { item.innerHTML = `${index + 1}. szó <div class="cooldown-timer"></div>`; updateCooldownTimer(item.querySelector('.cooldown-timer'), progress.failTimestamp); item.style.cursor = 'not-allowed'; } else { item.textContent = `${index + 1}. szó (Újra)`; item.style.cursor = 'pointer'; item.addEventListener('click', () => { gameData.progress[index] = {status: 'pending', scored: false}; gameData.timers[index] = 180; gameData.gameModes[index] = 'relax'; saveGame(); if (!checkAndDisplayIdleState()) { loadWord(index); } }); } } else { item.textContent = `${index + 1}. szó`; item.addEventListener('click', () => { if(index !== gameData.currentWordIndex && !gameData.isGameOver) loadWord(index); }); } if (index === gameData.currentWordIndex && !checkAndDisplayIdleState()) { item.classList.add('active'); } wordTrackerContainer.appendChild(item); }); }
        function updateCooldownTimer(element, failTimestamp) { if (!element) return; const intervalId = setInterval(() => { const remaining = failTimestamp + RETRY_COOLDOWN_MS - Date.now(); if (remaining <= 0) { clearInterval(intervalId); renderWordTracker(); return; } const minutes = Math.floor((remaining / 1000 / 60) % 60).toString().padStart(2, '0'); const seconds = Math.floor((remaining / 1000) % 60).toString().padStart(2, '0'); element.textContent = `${minutes}:${seconds}`; }, 1000); cooldownIntervals[element.parentElement.dataset.index] = intervalId; }
        function updateTimerDisplay(timeLeft) { if (timeLeft < 0) timeLeft = 0; const minutes = Math.floor(timeLeft / 60).toString().padStart(2, '0'); const seconds = (timeLeft % 60).toString().padStart(2, '0'); const timeString = `${minutes}:${seconds}`; const timerDisplayEl = document.getElementById('timer-display'); if (timerDisplayEl) timerDisplayEl.textContent = timeString; }
        function startTimer(duration) { clearInterval(timerInterval); let timeLeft = duration; updateTimerDisplay(timeLeft); timerInterval = setInterval(() => { if (gameData.isGameOver) { clearInterval(timerInterval); return; } timeLeft--; gameData.timers[gameData.currentWordIndex] = timeLeft; saveGame(); updateTimerDisplay(timeLeft); if (timeLeft <= 0) { clearInterval(timerInterval); clearInterval(randomMessageInterval); failWord(); } }, 1000); }
        function displayHint(isLetterHint) { clearTimeout(hintDisplayTimeout); clearInterval(randomMessageInterval); hintDisplayArea.innerHTML = `Lássuk csak...`; hintDisplayArea.classList.add('active'); setTimeout(() => { if (gameData.isGameOver) { showEndMessage(); return; } const hintsData = gameData.revealedHints[gameData.currentWordIndex]; hintsData.usedCount++; if (isLetterHint) { revealRandomLetter(); hintDisplayArea.innerHTML = 'Felfedtem egy betűt a rácson!'; } else { const wordObject = wordData[gameData.hourlySet[gameData.currentWordIndex]]; const nextHintIndex = hintsData.text.length; revealTextHint(nextHintIndex); hintDisplayArea.innerHTML = `<strong>${nextHintIndex + 1}. tipp:</strong> ${wordObject.hints[nextHintIndex]}`; } updateHintButtons(); saveGame(); hintDisplayTimeout = setTimeout(() => { hintDisplayArea.classList.remove('active'); startRandomMessageTimer(); }, 5000); }, 1500); }
        function revealTextHint(hintIndex) { const hintsData = gameData.revealedHints[gameData.currentWordIndex]; if (hintsData.text.includes(hintIndex)) return; hintsData.text.push(hintIndex); }
        function revealRandomLetter() { if (gameData.isGameOver) return; const wordObject = wordData[gameData.hourlySet[gameData.currentWordIndex]]; const targetWord = wordObject.word.toUpperCase(); const revealedIndices = gameData.revealedIndices[gameData.currentWordIndex]; const unrevealedWordIndices = []; for (let i = 0; i < targetWord.length; i++) { if (!revealedIndices.includes(i)) unrevealedWordIndices.push(i); } if (unrevealedWordIndices.length === 0) { requestLetterHintButton.disabled = true; return; } const indexToReveal = unrevealedWordIndices[Math.floor(Math.random() * unrevealedWordIndices.length)]; revealedIndices.push(indexToReveal); const letter = targetWord[indexToReveal]; for(let i=0; i<MAX_GUESSES; i++) { const cellFront = document.querySelector(`#row-${i} #cell-container-${i}-${indexToReveal} .cell-front`); if(cellFront) { cellFront.textContent = letter; cellFront.classList.add('cell-revealed'); } } updateKeyboard(letter, 'correct'); }
        function failWord() { gameData.isGameOver = true; gameData.progress[gameData.currentWordIndex].status = 'failed'; gameData.progress[gameData.currentWordIndex].failTimestamp = Date.now(); requestTextHintButton.disabled = true; requestLetterHintButton.disabled = true; keyboardContainer.classList.add('disabled'); showEndMessage(); saveGame(); renderWordTracker(); checkForBonusGameUnlock(); checkAndDisplayIdleState(); }
        function initializeGrid(wordLength) { gridContainer.innerHTML = ''; gridContainer.style.height = `auto`; for (let i = 0; i < MAX_GUESSES; i++) { const row = document.createElement('div'); row.className = 'grid-row'; row.id = `row-${i}`; row.style.gridTemplateColumns = `repeat(${wordLength}, 1fr)`; for (let j = 0; j < wordLength; j++) { row.innerHTML += `<div class="grid-cell" id="cell-container-${i}-${j}"><div class="cell-inner"><div class="cell-face cell-front"></div><div class="cell-face cell-back"></div></div></div>`; } gridContainer.appendChild(row); } const revealed = gameData.revealedIndices[gameData.currentWordIndex]; if (revealed && revealed.length > 0) { const targetWord = wordData[gameData.hourlySet[gameData.currentWordIndex]].word.toUpperCase(); revealed.forEach(index => { for(let i=0; i<MAX_GUESSES; i++) { const cellFront = document.querySelector(`#row-${i} #cell-container-${i}-${index} .cell-front`); if(cellFront) { cellFront.textContent = targetWord[index]; cellFront.classList.add('cell-revealed'); } } }); } }
        function initializeKeyboard() { keyboardContainer.innerHTML = ''; KEY_LAYOUT.forEach(rowKeys => { const row = document.createElement('div'); row.className = 'keyboard-row'; rowKeys.forEach(key => { const button = document.createElement('button'); button.textContent = key; button.className = 'key'; button.dataset.key = key.toUpperCase(); if (key === 'Enter' || key === 'Backspace') button.classList.add('large'); button.addEventListener('click', (e) => { e.preventDefault(); handleKeyPress(key); }); row.appendChild(button); }); keyboardContainer.appendChild(row); }); }
        function handleKeyPress(key) { if (gameData.isGameOver || wheelGameOverlay.classList.contains('visible') || keyboardContainer.classList.contains('disabled')) return; const upperKey = key.toUpperCase(); if (upperKey === 'ENTER') { submitGuess(); } else if (upperKey === 'BACKSPACE') { deleteLetter(); } else if (upperKey.length === 1 && KEY_LAYOUT.flat().join('').toUpperCase().includes(upperKey)) { addLetter(upperKey); } }
        function addLetter(letter) { const wordLength = wordData[gameData.hourlySet[gameData.currentWordIndex]].word.length; if (gameData.currentCol >= wordLength) return; const cell = document.querySelector(`#row-${gameData.currentRow}`).children[gameData.currentCol]; if (cell.querySelector('.cell-front').classList.contains('cell-revealed')) { gameData.currentCol++; if (gameData.currentCol < wordLength) addLetter(letter); else gameData.currentCol = wordLength; return; } if (cell) { cell.querySelector('.cell-front').textContent = letter; cell.classList.add('filled'); gameData.currentCol++; } }
        function deleteLetter() { if (gameData.currentCol <= 0) return; gameData.currentCol--; const cell = document.querySelector(`#row-${gameData.currentRow}`).children[gameData.currentCol]; if (cell.querySelector('.cell-front').classList.contains('cell-revealed')) { if(gameData.currentCol > 0) deleteLetter(); return; } if (cell) { cell.querySelector('.cell-front').textContent = ''; cell.classList.remove('filled'); } }
        function renderInfoBarFront() { infoBar.classList.remove('feedback-message'); const wordObject = wordData[gameData.hourlySet[gameData.currentWordIndex]]; const { word, category, difficulty } = wordObject; infoBar.innerHTML = `<div id="word-info-container"><span id="word-info">${category} | ${word.length} betűs</span><span id="difficulty-display" class="difficulty-${difficulty.toLowerCase().replace(/ /g, '-')}">${difficulty}</span></div><div id="game-mode-toggle"><span id="game-mode-label">Relax</span><span id="timer-display"></span></div>`; const gameModeToggle = document.getElementById('game-mode-toggle'); gameModeToggle.addEventListener('click', toggleGameMode); updateGameModeDisplay(); }
        function showFeedbackMessage(message) { infoBar.classList.add('feedback-message'); infoBar.innerHTML = message; setTimeout(() => { renderInfoBarFront(); }, 2500); }
        function showEndMessage() { const wordObject = wordData[gameData.hourlySet[gameData.currentWordIndex]]; const progress = gameData.progress[gameData.currentWordIndex]; if (progress.status === 'failed') { showFeedbackMessage(`Sajnos nem sikerült. A megoldás: <strong>${wordObject.word}</strong>.`); } else if (progress.status === 'solved' && !gameData.progress[gameData.currentWordIndex].scored) { showFeedbackMessage(`🎉 Ügyes! A helyes szó: <strong>${wordObject.word}</strong>. 🎉`); }}
        function flipRow(guess, targetWord) { const targetLetters = targetWord.split(''); const guessLetters = guess.split(''); const letterStates = Array(targetWord.length).fill('absent'); const usedTargetIndexes = new Set(); guessLetters.forEach((letter, index) => { if (letter === targetLetters[index]) { letterStates[index] = 'correct'; usedTargetIndexes.add(index); }}); guessLetters.forEach((letter, index) => { if (letterStates[index] !== 'correct') { const presentIndex = targetLetters.findIndex((l, i) => l === letter && !usedTargetIndexes.has(i)); if (presentIndex !== -1) { letterStates[index] = 'present'; usedTargetIndexes.add(presentIndex); } } }); const rowEl = document.getElementById(`row-${gameData.currentRow}`); for (let i = 0; i < targetWord.length; i++) { const cell = rowEl.children[i]; setTimeout(() => { cell.querySelector('.cell-back').textContent = guessLetters[i]; cell.querySelector('.cell-back').classList.add(letterStates[i]); cell.classList.add('flip'); updateKeyboard(guessLetters[i], letterStates[i]); }, i * 200); } }
        function updateKeyboard(letter, state) { const key = document.querySelector(`.key[data-key="${letter}"]`); if (!key) return; const priorities = { 'correct': 3, 'present': 2, 'absent': 1 }; const currentClass = key.classList.contains('correct') ? 'correct' : key.classList.contains('present') ? 'present' : 'absent'; if (!currentClass || priorities[state] > (priorities[currentClass] || 0)) { key.classList.remove('correct', 'present', 'absent'); key.classList.add(state); } }
        function checkForNewHour() { if (newSetOverlay.classList.contains('visible')) return; const currentSeed = getCurrentHourSeed(); if (gameData.seed && currentSeed !== gameData.seed) { newSetOverlay.classList.add('visible'); } }
        function updateHintButtons() { if (gameData.isGameOver) { requestTextHintButton.disabled = true; requestLetterHintButton.disabled = true; return; } const hintsData = gameData.revealedHints[gameData.currentWordIndex]; const hintsUsed = hintsData.usedCount || 0; const wordObject = wordData[gameData.hourlySet[gameData.currentWordIndex]]; const textHintsAvailable = hintsData.text.length < wordObject.hints.length; const areHintsExhausted = hintsUsed >= 3; requestTextHintButton.disabled = areHintsExhausted || !textHintsAvailable; requestLetterHintButton.disabled = areHintsExhausted; const textHintCost = calculateHintCost(false); const letterHintCost = calculateHintCost(true); requestTextHintButton.textContent = `Szöveges segítség (${textHintCost}p)`; requestLetterHintButton.textContent = `Betű felfedése (${letterHintCost}p)`; }
        function checkForBonusGameUnlock() { const allSolved = gameData.progress.every(p => p.status === 'solved'); if (allSolved && !gameData.bonusPlayed) { unlockBonusButton.disabled = false; unlockBonusButton.classList.add('unlocked', 'pulse'); } else { unlockBonusButton.disabled = true; unlockBonusButton.classList.remove('unlocked', 'pulse'); } }
        function seededRandom(seed) { let x = Math.sin(seed) * 10000; return x - Math.floor(x); }
        function getCurrentHourSeed() { const now = new Date(); return now.getFullYear() * 1000000 + (now.getMonth() + 1) * 10000 + now.getDate() * 100 + now.getHours(); }
        function toggleGameMode() { if (gameData.isGameOver) return; const currentMode = gameData.gameModes[gameData.currentWordIndex]; gameData.gameModes[gameData.currentWordIndex] = currentMode === 'relax' ? 'timed' : 'relax'; updateGameModeDisplay(); saveGame(); }
        function updateGameModeDisplay() { const mode = gameData.gameModes[gameData.currentWordIndex]; const modeLabel = document.getElementById('game-mode-label'); const timerDisplay = document.getElementById('timer-display'); if (mode === 'timed') { modeLabel.textContent = 'Időfutam'; timerDisplay.style.display = 'inline'; startTimer(gameData.timers[gameData.currentWordIndex]); } else { modeLabel.textContent = 'Relax'; timerDisplay.style.display = 'none'; clearInterval(timerInterval); } }
        function showRandomGameMessage() { if (gameData.isGameOver || wheelGameOverlay.classList.contains('visible') || hintDisplayArea.classList.contains('active') || checkAndDisplayIdleState()) return; showFeedbackMessage(`<i>${RANDOM_GAME_MESSAGES[Math.floor(Math.random() * RANDOM_GAME_MESSAGES.length)]}</i>`); }
        function startRandomMessageTimer() { clearInterval(randomMessageInterval); randomMessageInterval = setInterval(showRandomGameMessage, 30000 + Math.random() * 15000); }
        function checkAndDisplayIdleState() { const allWordsCompleted = gameData.progress.every(p => { const isRetryAvailable = p.status === 'failed' && (Date.now() - (p.failTimestamp || 0)) > RETRY_COOLDOWN_MS; return p.status === 'solved' || (p.status === 'failed' && !isRetryAvailable); }); if (allWordsCompleted) { gridContainer.style.display = 'none'; keyboardContainer.style.display = 'none'; hintControls.style.display = 'none'; infoBar.style.display = 'none'; clearInterval(randomMessageInterval); let msg; const allSolved = gameData.progress.every(p => p.status === 'solved'); if (allSolved && !gameData.bonusPlayed) { msg = BONUS_REMINDER_MESSAGES[getCurrentHourSeed() % BONUS_REMINDER_MESSAGES.length]; } else { msg = FUNNY_IDLE_MESSAGES[getCurrentHourSeed() % FUNNY_IDLE_MESSAGES.length]; } idleMessageContainer.innerHTML = `<h3>${msg.title}</h3><p>${msg.text}</p>`; idleMessageContainer.style.display = 'block'; return true; } else { gridContainer.style.display = 'grid'; keyboardContainer.style.display = 'flex'; hintControls.style.display = 'flex'; infoBar.style.display = 'flex'; idleMessageContainer.style.display = 'none'; return false; } }

        // --- ESEMÉNYKEZELŐK ---
        document.addEventListener('keydown', (e) => { if (document.querySelector('.overlay.visible') || ['INPUT', 'TEXTAREA','BUTTON'].includes(document.activeElement.tagName)) return; handleKeyPress(e.key); });
        refreshButton.addEventListener('click', () => location.reload());
        unlockBonusButton.addEventListener('click', () => { if(unlockBonusButton.classList.contains('unlocked')) initWheelGame(); });
        spinButton.addEventListener('click', togglePowerMeterAndSpin);
        powerMeterContainer.addEventListener('click', togglePowerMeterAndSpin);
        solveButton.addEventListener('click', solve);
        closeWheelButton.addEventListener('click', () => { wheelGameOverlay.classList.remove('visible'); updateDailyScoreDisplay(getDailyScore()); checkForBonusGameUnlock(); checkAndDisplayIdleState(); });
        cashOutButton.addEventListener('click', cashOut);
        nextRoundButton.addEventListener('click', startNewRound);
        requestTextHintButton.addEventListener('click', () => { const hintsData = gameData.revealedHints[gameData.currentWordIndex]; const wordObject = wordData[gameData.hourlySet[gameData.currentWordIndex]]; if ((hintsData.usedCount || 0) >= 3 || hintsData.text.length >= wordObject.hints.length) { alert("Nincs több elérhető szöveges segítség ehhez a szóhoz, vagy elérted a limidet!"); return;} if(spendPointsForHint(false)) { displayHint(false); } });
        requestLetterHintButton.addEventListener('click', () => { const hintsData = gameData.revealedHints[gameData.currentWordIndex]; if ((hintsData.usedCount || 0) >= 3) { alert("Elérted a maximális segítségkérést ehhez a szóhoz!"); return; } if(spendPointsForHint(true)) { displayHint(true); } });
        
        // --- INDÍTÁS ---
        populateThemePicker();
        loadTheme();
        initGame();
    });
    </script>
</body>
</html>
